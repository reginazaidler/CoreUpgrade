<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8" />
      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <title>Core Upgrade Effort Estimator - Sapiens</title>
      <style>
         :root{
         --brand-navy:#01133A;
         --brand-navy-2:#002256;
         --brand-cyan:#00A9E0;
         --bg:#F5F5F6;
         --card:#FFFFFF;
         --border:#D9DEE7;
         --text:#1F2A44;
         --muted:#6B778C;
		--btn-radius:10px;
         --btn-height:42px;
         --font-display:clamp(1.75rem, 1.15rem + 1.5vw, 2.25rem);
         --font-h2:clamp(1.05rem, 0.95rem + 0.35vw, 1.3rem);
         --font-h3:1rem;
         --font-body:0.95rem;
         --font-small:0.825rem;
         --font-xs:0.76rem;
         --lh-tight:1.25;
         --lh-body:1.55;
		 
         --sapiens-blue: var(--brand-navy-2);
         --sapiens-cyan: var(--brand-cyan);
         }
         * { margin: 0; padding: 0; box-sizing: border-box; }
         body{
         font-family:"Segoe UI", Tahoma, Arial, sans-serif;
         background: var(--bg);
         color: var(--text);
         min-height:100vh;
         margin:0;
         padding:0;
         }

         .muted{ color: var(--muted); font-size:12px; }
         .checkbox-sm{ width:18px; height:18px; accent-color: var(--brand-cyan); }
         .app-shell{
         min-height:100vh;
         display:flex;
         flex-direction:column;
         }
         .topbar{
         height:56px;
         background: var(--brand-navy);
         color:#fff;
         display:flex;
         align-items:center;
		          justify-content: space-between;
         padding:0 16px;
         gap:12px;
         border-bottom:1px solid rgba(255,255,255,0.08);
                  box-shadow: 0 2px 10px rgba(0,0,0,0.2);
         }
		 .topbar-logo {
  height: 28px;   /* Compact and professional */
  width: auto;
  display: block;
 
}

         .page{
         padding:24px;
		          background: radial-gradient(circle at top right, rgba(0,169,224,0.07), transparent 35%);
         }
         .container{
		          margin:0 auto;
         background: var(--card);
         padding:24px;
         border-radius:16px;
         border:1px solid var(--border);
         box-shadow:0 10px 30px rgba(1,19,58,0.08);
         text-align:left;
         max-width:1180px;
         width:100%;
         position:relative;
         }
         .stepper{
         position:absolute;
         top:12px;
         right:12px;
         
		 width:min(250px, 42vw);
         display:flex;
         flex-direction:column;
         gap:8px;
         }
         .stepper-track{
         position:relative;
         height:6px;
         border-radius:999px;
         background:#E6ECF5;
         overflow:hidden;
         }
         .stepper-progress{
         height:100%;
         width:0%;
         border-radius:inherit;
         background:linear-gradient(90deg, var(--brand-blue), #35B8F1);
         transition:width .25s ease;
         }
         .stepper-points{
         display:flex;
         justify-content:space-between;
         align-items:flex-start;
         }
         .stepper-point{
         display:flex;
         flex-direction:column;
         align-items:center;
         gap:4px;
         min-width:82px;
         color:#8B97A8;
         font-size:11px;
         font-weight:600;
         text-transform:uppercase;
         letter-spacing:0.04em;
         transition:color .2s ease;
         }
         .stepper-point-dot{
         width:14px;
         height:14px;
         border-radius:50%;
         border:2px solid #B9C5D8;
         background:#fff;
         box-shadow:0 0 0 2px rgba(255,255,255,0.85);
         transition:all .2s ease;
         }
         .stepper-point.active,
         .stepper-point.completed{
         color:var(--brand-navy-2);
         }
         .stepper-point.active .stepper-point-dot,
         .stepper-point.completed .stepper-point-dot{
         border-color:var(--brand-blue);
         background:var(--brand-blue);
         }
         
         h1 {
         color: var(--brand-navy-2);
         margin-bottom: 12px;
         font-size: 28px;
         font-weight: 600;
         }
         .intro-text {
         color: #7f8c8d;
         font-size: 15px;
         margin-bottom: 18px;
         line-height: 1.6;
         }
         .initial-select{
         width:100%;
         padding:10px 12px;
         border:1px solid var(--border);
         border-radius:4px;
         font-size:14px;
         background:#FBFCFE;
         cursor:pointer;
         margin-bottom:12px;
         color: var(--text);
         outline:none;
         }
         .initial-select:focus{
         border-color: var(--brand-cyan);
         box-shadow: 0 0 0 3px rgba(0,169,224,0.15);
         transform:none;
         }
         .upload-box {
         margin-top: 6px;
         padding: 18px;
         background: #f8f9fa;
         border-radius: 12px;
         border: 2px dashed var(--brand-cyan);
         text-align: left;
         }
         .upload-box label {
         display: block;
         font-weight: 600;
         color: var(--brand-navy-2);
         margin-bottom: 8px;
         font-size: 13px;
         }
         .upload-box input[type=file] {
         width: 100%;
         padding: 12px;
         border: 2px solid #ddd;
         border-radius: 8px;
         background: white;
         }
         .upload-box small {
         display: block;
         margin-top: 8px;
         color: #7f8c8d;
         font-size: 13px;
         line-height: 1.5;
         }
         .next-button,
         .calculate-btn,
         .back-button,
         .csv-btn,
         .icon-btn{
         border-radius:var(--btn-radius);
         font-weight:600;
         font-size:13px;
         cursor:pointer;
         border:1px solid transparent;
         min-height:var(--btn-height);
         transition:background-color .2s ease, color .2s ease, border-color .2s ease, transform .15s ease, box-shadow .2s ease;
         display:inline-flex;
         align-items:center;
         justify-content:center;
         gap:6px;
         }
         .next-button,
         .calculate-btn{
         background: linear-gradient(135deg, var(--brand-cyan), var(--brand-navy-2));
         color:#fff;
         border-color:transparent;
         box-shadow:0 8px 20px rgba(0,169,224,0.25);
         padding:10px 16px;
         }
         .next-button{
         width:100%;
         margin-top:14px;
         font-size:15px;
         min-height:48px;
         }
         .next-button:hover:not(:disabled),
         .calculate-btn:hover:not(:disabled){
         transform:translateY(-1px);
         box-shadow:0 10px 22px rgba(0,169,224,0.3);
         }
         .next-button:disabled,
         .calculate-btn:disabled,
         .back-button:disabled,
         .csv-btn:disabled,
         .icon-btn:disabled{
         background:#E2E8F1;
         color:#8A95A6;
         border-color:#D0D8E4;
         cursor:not-allowed;
         box-shadow:none;
         transform:none;
         }
         .form-section { display: none; text-align: left; }
         .step-indicator{
         display:inline-flex;
         align-items:center;
         padding:4px 10px;
         border-radius:999px;
         border:1px solid #D6DEEA;
         background:#F6F9FD;
         color:#4E5D78;
         font-size:12px;
         font-weight:600;
         margin-bottom:10px;
         }
         .back-button:hover{
         background:#F3F6FA;
         }
         .form-header{
         background:linear-gradient(120deg, #EEF2F7, #F8FAFD);
         padding:16px;
         border-radius:12px;
         margin-bottom:16px;
         border:1px solid var(--border);
         }
         .form-header h3{
         color: var(--text);
         font-size:20px;
         margin-bottom:10px;
         font-weight:600;
         }
		  .form-header-subtitle{
         margin:8px 0 0;
         color:var(--muted);
         font-size:13px;
         line-height:1.4;
         }
         .upgrade-type-badge{
         display:inline-block;
         background: var(--brand-navy-2);
         color:#fff;
         padding:6px 10px;
         border-radius:999px;
         font-weight:600;
         font-size:12px;
         }
		  .upgrade-type-badge:empty{
         display:none;
         }
         .note {
         color: #2c3e50;
         font-size: 14px;
         line-height: 1.6;
         background: #f8f9fa;
         border: 1px solid #e1e5ea;
         padding: 14px 16px;
         border-radius: 12px;
         text-align: left;
         margin-top: 14px;
         }
         .param-sections{
  display:flex;
  flex-direction:column;
  gap:16px;
  margin-top:12px;
}
         .section-card{
         background:#fff;
         border-radius:12px;
         padding:16px;
         box-shadow:0 3px 14px rgba(1,19,58,0.04);
         }
         
         .span-2{ grid-column: 1 / -1; }

         #riskBufferCard .form-table td:first-child{ width:42%; }
         #riskBufferCard .form-table td:last-child{ width:58%; }
         #riskBufferCard .form-table td{ padding:10px 10px; }
         #riskBufferCard .section-hint{ margin-bottom:12px; }
         #riskBufferCard .manual-tasks-header{
           display:flex;
           align-items:center;
           justify-content:space-between;
           gap:10px;
           margin-top:6px;
         }
         #riskBufferCard .manual-tasks-actions{
           display:flex;
           align-items:center;
           gap:10px;
         }
         #riskBufferCard .manual-empty{
           padding:16px 10px;
           color: var(--muted);
           font-size:12px;
         }
         #riskBufferCard .manual-table-wrap{
           border:1px solid var(--border);
           border-radius:8px;
           overflow:hidden;
           background:#fff;
           margin-top:10px;
         }
         #riskBufferCard .manual-table{
           width:100%;
           border-collapse:collapse;
           margin:0;
           table-layout:fixed;
         }
         #riskBufferCard .manual-table th,
         #riskBufferCard .manual-table td{
           padding:8px 8px;
           border-bottom:1px solid var(--border);
           font-size:12px;
         }
         #riskBufferCard .manual-table th{
           background:#EEF2F7;
           font-weight:700;
         }
         #riskBufferCard .manual-table td input,
         #riskBufferCard .manual-table td select{
           width:100%;
           padding:7px 8px;
           font-size:12px;
         }
         #riskBufferCard .manual-table th:nth-child(1){ width:22%; }
         #riskBufferCard .manual-table th:nth-child(2){ width:18%; }
         #riskBufferCard .manual-table th:nth-child(3){ width:18%; }
         #riskBufferCard .manual-table th:nth-child(4){ width:12%; }
         #riskBufferCard .manual-table th:nth-child(5){ width:22%; }
         #riskBufferCard .manual-table th:nth-child(6){ width:8%; }
.section-title{
         display:flex;
         align-items:center;
         justify-content:space-between;
         gap:10px;
         margin-bottom:8px;
         }
         .section-title h4{
         margin:0;
         font-size:15px;
         font-weight:700;
         color:var(--text);
         }
         .badge{
         font-size:11px;
         font-weight:700;
         padding:4px 8px;
         border-radius:999px;
         border:1px solid var(--border);
         background:#EEF2F7;
         color:var(--text);
         white-space:nowrap;
         }
         .badge-auto{
         background: rgba(0,169,224,0.10);
         border-color: rgba(0,169,224,0.35);
         color: var(--text);
         }
         .badge-manual{
         background: rgba(1,19,58,0.08);
         border-color: rgba(1,19,58,0.20);
         color: var(--text);
         }
         .section-hint{
         font-size:12px;
         color: var(--muted);
         margin:0 0 12px 0;
         line-height:1.5;
         }
         .form-table{
         width:100%;
         border-collapse:collapse;
         margin-top:6px;
		 border:1px solid #E9EEF5;
         border-radius:10px;
         overflow:visible;
         }
         /* interfaces rows table: 3 columns (type / qty / remove) */
         .interfaces-table{
         width:100%;
         border-collapse:collapse;
         margin-top:6px;
         }
         .interfaces-table td{
         border-bottom:1px solid var(--border);
         padding:8px 8px;
         vertical-align:middle;
         }
         .interfaces-table tr:first-child td{
         font-size:12px;
         font-weight:700;
         color: var(--text);
         background:#EEF2F7;
         border-bottom:1px solid var(--border);
         }
         .interfaces-table td:nth-child(1){ width:65%; }
         .interfaces-table td:nth-child(2){ width:15%; }
         .interfaces-table td:nth-child(3){ width:20%; }
         .interfaces-table .interface-qty{
         min-width:70px;
         }
         .form-table td{
         border-bottom:1px solid var(--border);
         padding:10px 10px;
         vertical-align:middle;
         }
		 .form-table tr:nth-child(odd){
         background:#FCFDFF;
         }
         .form-table tr:hover{
         background:#F4F9FD;
         }
         .form-table td:first-child{
         width:60%;
         color: var(--text);
         font-size:12px;
         font-weight:600;
         }
         .form-table td:last-child{
         width:40%;
         }
         .input-sm{
         width:100%;
         padding:9px 11px;
         border:1px solid var(--border);
         border-radius:8px;
         font-size:13px;
         background:#FBFCFE;
         color:var(--text);
         }
		 .input-sm:focus,
         input[type=text]:focus,
         select:focus{
         border-color: var(--brand-cyan);
         box-shadow: 0 0 0 3px rgba(0,169,224,0.14);
         outline:none;
         }
         @media (max-width: 900px){
         .param-sections{ grid-template-columns: 1fr; }
         .span-2{ grid-column: auto; }
         }
         .note strong { color: var(--brand-navy-2); }
         .input-grid {
         display: grid;
         grid-template-columns: 1.7fr 1fr;
         gap: 18px;
         margin-top: 16px;
         margin-bottom: 22px;
         }
         .input-group { margin-bottom: 5px; }
         label{
         display:block;
         font-weight:600;
         margin-bottom:6px;
         color: var(--text);
         font-size:12px;
         }
         /* Help tooltip (clickable i) */
         .label-with-help{
         display:inline-flex;
         align-items:center;
         gap:8px;
         margin:0;
         line-height:1.2;
         }
         .help-icon{
         display:inline-flex;
         align-items:center;
         justify-content:center;
         width:18px;
         height:18px;
         border-radius:50%;
         border:1px solid var(--border);
         background:#F3F6FA;
         color: var(--brand-navy-2);
         font-size:12px;
         font-weight:700;
         cursor:pointer;
         user-select:none;
         position:relative;
         line-height:18px;
         flex:0 0 auto;
         }
         .help-icon::after {
         content: attr(data-tooltip);
         position: absolute;
         left: 0;
         top: 120%;
         min-width: 260px;
         max-width: 360px;
         padding: 10px 12px;
         border-radius: 10px;
         background: #2c3e50;
         color: white;
         font-size: 12px;
         font-weight: 500;
         line-height: 1.4;
		 white-space: pre-line;
         word-break: break-word;
         box-shadow: 0 10px 24px rgba(0,0,0,0.18);
         display: none;
         z-index: 50;
         }
         .help-icon::before {
         content: "";
         position: absolute;
         left: 8px;
         top: 108%;
         border: 6px solid transparent;
         border-bottom-color: #2c3e50;
         display: none;
         z-index: 51;
         }
		 

         .help-icon:hover::after,
         .help-icon:focus::after,
         .help-icon:hover::before,
         .help-icon:focus::before {
         display: block;
         }
         
         input[type=number]{
         width:100%;
         padding:10px 12px;
         border:1px solid var(--border);
         border-radius:4px;
         font-size:14px;
         background:#FBFCFE;
         color: var(--text);
         outline:none;
         }
         input[type=number]:focus{
         border-color: var(--brand-cyan);
         box-shadow: 0 0 0 3px rgba(0,169,224,0.15);
         }
         .calculate-btn{
         background: linear-gradient(140deg, var(--brand-navy-2), #0a4b99);
         color:#fff;
         padding:11px 18px;
         border:1px solid transparent;
         border-radius:10px;
         font-size:14px;
         font-weight:600;
         cursor:pointer;
         box-shadow:0 8px 18px rgba(1,19,58,0.2);
         }
         .calculate-btn:hover{
         transform: translateY(-1px);
         box-shadow:0 10px 22px rgba(1,19,58,0.25);
         }

         #step2ActionsBar{
         margin-top:22px;
         display:flex;
         justify-content:center;
         padding:14px;
         background:#fff;
         border:1px solid var(--border);
         border-radius:12px;
         position:sticky;
         bottom:12px;
         z-index:6;
         box-shadow:0 8px 22px rgba(1,19,58,0.12);
         }

         @media (max-width: 768px){
         .page{ padding:14px; }
         .container{ padding:14px; border-radius:12px; }
         .form-header h3{ font-size:17px; }
         #step2ActionsBar{ position:static; }
         }
         .results{
         margin-top:16px;
         padding:16px;
         background:#fff;
         border:1px solid var(--border);
         border-radius:6px;
         }
         .total-result{
         font-size:24px;
         font-weight:700;
         color: var(--text);
         text-align:left;
         margin:12px 0 12px 0;
         }
         table{
         width:100%;
         border-collapse:collapse;
         margin-top:12px;
         background:#fff;
         border:1px solid var(--border);
         border-radius:6px;
         overflow:hidden;
         box-shadow:none;
         }
         th, td{
         padding:10px 12px;
         text-align:left;
         }
         th{
         background:#EEF2F7;
         color: var(--text);
         font-weight:600;
         font-size:12px;
         border-bottom:1px solid var(--border);
         }
         td{
         font-size:13px;
         color: var(--text);
         border-bottom:1px solid var(--border);
         }
         tr:nth-child(even){
         background:#FAFBFD;
         }
         .detailed-table{
         font-size:12px;
		  table-layout:fixed;
         }
         .detailed-table th{
         background:#EEF2F7;
         }
		 #detailedTable th:nth-child(3),
         #detailedTable td:nth-child(3){ width:22%; }
         #detailedTable th:nth-child(9),
         #detailedTable td:nth-child(9){ width:18%; }
         .total-row{
         font-weight:700;
         background:#F3F6FA !important;
         }
         details { margin-top: 22px; }
         summary {
         cursor: pointer;
         font-weight: 600;
         color: var(--brand-navy-2);
         padding: 10px;
         background: #f8f9fa;
         border-radius: 8px;
         }
         .csv-btn{
         background:#fff;
         color: var(--brand-navy-2);
         border:1px solid var(--border);
         margin-top:12px;
         width:auto;
         padding:10px 14px;
         }

         .icon-btn{
         background:#fff;
         color: var(--muted);
         border:1px solid var(--border);
         border-radius:6px;
         padding:6px 10px;
         cursor:pointer;
         }
         .icon-btn:hover{ background:#F3F6FA; color: var(--text); }
         @media (max-width: 768px) {
         .container { padding: 30px 20px; }
         .input-grid { grid-template-columns: 1fr; }
         h1 { font-size: 24px; }
         }
      
         /* Jira help modal */
         .modal{
         position:fixed;
         inset:0;
         background:rgba(0,0,0,0.4);
         display:flex;
         align-items:center;
         justify-content:center;
         z-index:1000;
         }
         .modal.hidden{ display:none; }
         .modal-content{
         background:#ffffff;
         width:760px;
         max-width:92%;
         max-height:85vh;
         border-radius:10px;
         border:1px solid var(--border);
         box-shadow:0 14px 40px rgba(0,0,0,0.25);
         display:flex;
         flex-direction:column;
         overflow:hidden;
         }
         .modal-header{
         padding:14px 16px;
         border-bottom:1px solid var(--border);
         display:flex;
         align-items:center;
         justify-content:space-between;
         gap:12px;
         background:#FBFCFE;
         }
         .modal-header h2{
         font-size:14px;
         font-weight:700;
         margin:0;
         color:var(--text);
         }
         .modal-body{
         padding:16px;
         overflow:auto;
         font-size:13px;
         color:var(--text);
         line-height:1.55;
         }
         .modal-body ol{ padding-left:18px; }
         .modal-body li{ margin:8px 0; }
         .modal-body img{
         max-width:100%;
         height:auto;
         border:1px solid var(--border);
         border-radius:8px;
         margin-top:10px;
         }
         .modal-close{
         background:#fff;
         border:1px solid var(--border);
         color:var(--text);
         width:30px;
         height:30px;
         border-radius:8px;
         cursor:pointer;
         font-size:18px;
         line-height:28px;
         text-align:center;
         }
         .modal-close:hover{ background:#F3F6FA; }

      

.topbar .brand-left{
  display:flex;
  align-items:center;
  gap:12px;
}

.topbar .brand-title{
  font-weight:700;
  font-size: 16px;
  letter-spacing: .4px;
}


/* Auto details toggles */
.input-with-action{
  display:flex;
  align-items:center;
  gap:10px;
}
.link-button{
  border:none;
  background: transparent;
  color: var(--brand-cyan);
  font-weight: 700;
  cursor:pointer;
  padding: 6px 0;
  white-space: nowrap;
}
.link-button:hover{ text-decoration: underline; }

.details-row td{
  padding-top: 0;
}
.details-panel{
  border: 1px solid var(--border);
  background: #f0faff;
  border-radius: 10px;
  padding: 12px 12px;
  margin: 8px 0 6px 0;
}
.details-panel .details-head{
  display:flex;
  align-items:center;
  justify-content: space-between;
  gap: 10px;
  margin-bottom: 8px;
}
.details-panel .details-title{
  font-weight: 800;
  color: var(--brand-navy);
  font-size: 13px;
}
.details-panel .details-count{
  font-size: 12px;
  color: var(--muted);
}
.details-list{
  max-height: 180px;
    overflow-y:auto;
  overflow-x:hidden;
  background:#fff;
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 8px;
  font-size: 12px;
  line-height: 1.45;
}
.details-list .details-item{
  padding: 4px 6px;
  border-radius: 6px;
  white-space: normal;
  overflow-wrap: anywhere;
  word-break: break-word;
}
.details-list .details-item:nth-child(odd){
  background: #f7fbff;
}
.details-empty{
  color: var(--muted);
}


/* Manual tasks within Risk and Buffer */
.card-divider{
  border:0;
  border-top:1px solid var(--border);
  margin:12px 0;
}
.manual-table-wrap{
  width:100%;
  overflow-x:auto;
}
#manualTasksTable{
  min-width: 760px;
}


/* Tech Stack Delta (3-column) */
#techStackFullCard .tech-delta-table th{
  background:#EEF2F7;
  font-weight:700;
  font-size:12px;
  border-bottom:1px solid var(--border);
}
#techStackFullCard .tech-delta-table th, 
#techStackFullCard .tech-delta-table td{
  padding:8px 8px;
}
#techStackFullCard .tech-delta-table td{
  border-bottom:1px solid var(--border);
  font-size:12px;
}
#techStackFullCard .tech-delta-table td:nth-child(1){ width:24%; font-weight:700; color:var(--text); }
#techStackFullCard .tech-delta-table td:nth-child(2),
#techStackFullCard .tech-delta-table td:nth-child(3){ width:38%; color:var(--text); }


/* Editable task breakdown inline add-row button */
.row-add-btn{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  width:22px;
  height:22px;
  margin-right:8px;
  border:1px solid var(--border);
  background:#fff;
  color:var(--brand-navy-2);
  border-radius:999px;
  font-weight:700;
  line-height:1;
  cursor:pointer;
}
.row-add-btn:hover{ background:#f3f6fb; }
.row-add-btn:active{ transform:translateY(1px); }
.row-add-btn::before{ content:"+"; }

.detailed-input{
  width:100%;
  box-sizing:border-box;
  padding:6px 8px;
  border:1px solid var(--border);
  border-radius:6px;
  font-size:12px;
}
.detailed-input-sm{
  width:80px;
}
.detailed-input-md{
  width:110px;
}
.detailed-muted{
  color:var(--muted);
  font-size:12px;
}


         /* Executive summary tiles */
         .summary-tiles{
           display:grid;
           grid-template-columns: repeat(4, minmax(0, 1fr));
           gap: 12px;
           margin: 10px 0 16px 0;
         }
         @media (max-width: 1100px){
           .summary-tiles{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
         }
         @media (max-width: 620px){
           .summary-tiles{ grid-template-columns: 1fr; }
         }
         .summary-tile{
           background: #FFFFFF;
           border: 1px solid #E6E8EE;
           border-radius: 12px;
           padding: 12px 14px;
           box-shadow: 0 1px 2px rgba(16, 24, 40, 0.06);
         }
         .summary-tile .label{
           font-size: 12px;
           color: #667085;
           font-weight: 600;
           letter-spacing: .2px;
           margin-bottom: 6px;
         }
         .summary-tile .value{
           font-size: 22px;
           font-weight: 800;
           color: var(--brand-navy-2);
           line-height: 1.15;
           white-space: nowrap;
           overflow: hidden;
           text-overflow: ellipsis;
         }
         .summary-tile .hint{
           margin-top: 6px;
           font-size: 12px;
           color: #98A2B3;
         }

      </style>
   </head>
   <body>
   
      <div class="app-shell">
         <div class="topbar">
  <div class="brand-left">
    <img class="topbar-logo" src="data:image/png;base64,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" alt="Sapiens" />
    <div class="brand-title">Core Upgrade Effort Estimator</div>
  </div>
</div>

<div class="page">
            <div class="container">
               <!-- Step 1 -->
               <div id="step1">
			                  <div class="step-indicator" data-step-indicator>Page 1 of 2</div>
                  <h1>Core Upgrade Effort Estimator</h1>
<div style="display:flex; gap:10px; margin:10px 0 20px 0; flex-wrap:wrap;">
  <button class="calculate-btn csv-btn" type="button" id="importJsonBtnStep1">Import JSON</button>
</div>
<input type="file" id="importJsonFile" accept=".json,application/json" style="display:none;" />
                  <p class="intro-text">
                     Select upgrade scope. Optionally upload ReleasedFileChanges.txt to auto-calculate key totals.
                  </p>
                  <select id="upgradeType" class="initial-select" style="display:none">
                     <option value="">Select upgrade scope...</option>
                     <option value="major">Major - Big Bang upgrade (2 core versions and up)</option>
                     <option value="annual">Continuous upgrade - Annual (1 core version)</option>
                     <option value="quarterly">Continuous upgrade - Quarterly</option>
                  </select>
                  <div class="input-grid" style="margin-top:14px; margin-bottom:12px;">
                     <div class="input-group">
                        <label for="coreFrom">Core version - From</label>
                        <select class="initial-select" id="coreFrom">
                           <option value="">Select...</option>
                           <option value="core16_0">core 16.0</option>
                           <option value="core17_0">core 17.0</option>
                           <option value="core18_0">core 18.0</option>
                           <option value="core19_1">core 19.1</option>
                           <option value="core19_2">core 19.2</option>
                           <option value="core20_2">core 20.2</option>
                           <option value="core21_3">core 21.3</option>
                        </select>
                     </div>
                     <div class="input-group">
                        <label for="coreTo">Core version - To</label>
                        <select class="initial-select" id="coreTo">
                           <option value="">Select...</option>
                           <option value="core16_0">core 16.0</option>
                           <option value="core17_0">core 17.0</option>
                           <option value="core18_0">core 18.0</option>
                           <option value="core19_1">core 19.1</option>
                           <option value="core19_2">core 19.2</option>
                           <option value="core20_2">core 20.2</option>
                           <option value="core21_3">core 21.3</option>
                        </select>
                     </div>
                  </div>
<div class="upload-box">
                     <label>Upload ReleasedFileChanges.txt (optional auto-calculate)</label>
                     <input type="file" id="txtUpload" accept=".txt" />
                     <small>
                     The tool will calculate totals across the entire file:
                     XML files (*.xml), JSP files (*.jsp), Changed Methods totals, and Changed Queries totals.
                     You can review and adjust all values on the next page.
                     </small>
                  </div>
                  <button id="nextBtn" class="next-button" disabled>Continue to parameters</button>
               </div>
               <!-- Step 2 -->
               <div id="step2" class="form-section">
                  <button class="back-button" onclick="goBack()">Back</button>
                  <div class="form-header">
				    <div class="step-indicator" data-step-indicator>Page 2 of 2</div>
                     <h3>Project Parameters</h3>
                     <span class="upgrade-type-badge" id="upgradeTypeBadge"></span>
                  </div>
                  <div class="param-sections">

                     
                     
                     <div class="section-card" id="upgradeScopeCard">
                       <div class="section-title">
                         <h4>Upgrade Scope Summary</h4>
                       </div>
                       <p class="section-hint">
                         Derived from selected core versions (read-only).
                       </p>
                       <table class="form-table">
                         <tbody id="upgradeScopeTbody"></tbody>
                       </table>
                     </div>
                     <div class="section-card" id="techStackFullCard">
                       <div class="section-title">
                         <h4>Technology Stack Delta (review and tag impact)</h4>
                         <span class="badge badge-auto">AUTO</span>
                       </div>
                       <p class="section-hint">
                         Auto-derived full comparison for the selected versions (read-only).
<br>
<strong>TODO</strong> - add per item tags: affects Development and-or DevOps, and later decide if it should affect the estimate.
                       </p>
                       <table class="form-table tech-delta-table">
        <thead>
        <tr>
          <th>Technology area</th>
          <th>Current version</th>
          <th>Target version</th>
          <th>Development effort required</th>
          <th>DevOps Only</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
  <tbody id="techStackFullTbody"></tbody>
</table>

<div class="note" style="margin-top:10px;">
  <strong>TODO - impact tagging</strong><br/>
  Consider adding per-row checkboxes to tag whether each technology change affects <strong>Development</strong>, <strong>DevOps</strong>, or both.
  This can later be used to split effort attribution and improve the work plan.
</div>

                     </div>
                     <!-- Section A: Auto calculated -->
                     <div class="section-card">
                        <div class="section-title">
                           <h4>Auto-calculated from file</h4>
                           <span class="badge badge-auto">AUTO</span>
                        </div>
                        <p class="section-hint">
                           If you uploaded ReleasedFileChanges.txt, these values were calculated automatically.
                           Review and override only if needed.
                        </p>
                        <table class="form-table">
                           <tr>
                              <td>XML files (count)</td>
                              <td><div class="input-with-action"><input class="input-sm" type="number" id="xmlFiles" min="0" value="0" disabled /><button type="button" class="link-button auto-details-toggle" data-metric="xmlFiles">Details</button></div></td>                           <tr class="details-row" id="xmlFilesDetailsRow" style="display:none;">
                              <td colspan="2">
                                 <div class="details-panel">
                                    <div class="details-head">
                                       <div class="details-title">XML files - details</div>
                                       <div class="details-count" id="xmlFilesDetailsCount"></div>
                                    </div>
                                    <div class="details-list" id="xmlFilesDetailsList"><span class="details-empty">No details loaded.</span></div>
                                 </div>
                              </td>
                           </tr>
                           <tr>
                              <td>JSP files (count)</td>
                              <td><div class="input-with-action"><input class="input-sm" type="number" id="jspFiles" min="0" value="0" disabled /><button type="button" class="link-button auto-details-toggle" data-metric="jspFiles">Details</button></div></td>                           </tr>
                           <tr class="details-row" id="jspFilesDetailsRow" style="display:none;">
                              <td colspan="2">
                                 <div class="details-panel">
                                    <div class="details-head">
                                       <div class="details-title">JSP files - details</div>
                                       <div class="details-count" id="jspFilesDetailsCount"></div>
                                    </div>
                                    <div class="details-list" id="jspFilesDetailsList"><span class="details-empty">No details loaded.</span></div>
                                 </div>
                              </td>
                           </tr>
                           <tr>
                              <td>Changed methods (total)</td>
                              <td><div class="input-with-action"><input class="input-sm" type="number" id="changedMethods" min="0" value="0" disabled /><button type="button" class="link-button auto-details-toggle" data-metric="changedMethods">Details</button></div></td>                           </tr>
                           <tr class="details-row" id="changedMethodsDetailsRow" style="display:none;">
                              <td colspan="2">
                                 <div class="details-panel">
                                    <div class="details-head">
                                       <div class="details-title">Changed methods - details</div>
                                       <div class="details-count" id="changedMethodsDetailsCount"></div>
                                    </div>
                                    <div class="details-list" id="changedMethodsDetailsList"><span class="details-empty">No details loaded.</span></div>
                                 </div>
                              </td>
                           </tr>
                           <tr>
                              <td>Changed queries (total)</td>
                              <td><div class="input-with-action"><input class="input-sm" type="number" id="changedQueries" min="0" value="0" disabled /><button type="button" class="link-button auto-details-toggle" data-metric="changedQueries">Details</button></div></td>                           <tr class="details-row" id="changedQueriesDetailsRow" style="display:none;">
                              <td colspan="2">
                                 <div class="details-panel">
                                    <div class="details-head">
                                       <div class="details-title">Changed queries - details</div>
                                       <div class="details-count" id="changedQueriesDetailsCount"></div>
                                    </div>
                                    <div class="details-list" id="changedQueriesDetailsList"><span class="details-empty">No details loaded.</span></div>
                                 </div>
                              </td>
                           </tr>
                           <tr>
                              <td>SessionBean occurrences (count)</td>
                              <td><div class="input-with-action"><input class="input-sm" type="number" id="sessionBeans" min="0" value="0" disabled /><button type="button" class="link-button auto-details-toggle" data-metric="sessionBeans">Details</button></div></td>                           </tr>
                           <tr class="details-row" id="sessionBeansDetailsRow" style="display:none;">
                              <td colspan="2">
                                 <div class="details-panel">
                                    <div class="details-head">
                                       <div class="details-title">SessionBean occurrences - details</div>
                                       <div class="details-count" id="sessionBeansDetailsCount"></div>
                                    </div>
                                    <div class="details-list" id="sessionBeansDetailsList"><span class="details-empty">No details loaded.</span></div>
                                 </div>
                              </td>
                           </tr>
                        </table>
                     </div>
        
                     

             
                      <!-- Section B: Manual inputs -->
                     <div class="section-card span-2">
					 
                        <div class="section-title">
                           <h4>Manual inputs</h4>
                           <span class="badge badge-manual">YOU MUST TYPE</span>
                        </div>
                        <p class="section-hint">
                           These values are project-specific and are not calculated from the file.
                        </p>
                        <table class="form-table">
<tr>
                              <td>
                                 <span class="label-with-help">
                                 COPRs to remove (count)
                                 <span class="help-icon" tabindex="0"
                                    data-tooltip="Go over the list of coprs that were raised by the project in the past and resolved temporarely in the project and are now resolved by CORE and remove project layer fix and unit test with core fix">i</span>
                                 </span>
                              </td>
                              <td><input class="input-sm" type="number" id="coprs" min="0" value="0" /></td>
                           </tr>
                           <tr>
                              <td>
                                 <span class="label-with-help">
                                 Stabilization of project batches / interfaces required
                                 <span class="help-icon" tabindex="0"
                                    data-tooltip="Add project-specific batch/interface stabilization effort impacted by the core upgrade. You can add multiple types and quantities.">i</span>
                                 </span>
                              </td>
                              <td>
                                 <select class="input-sm" id="interfacesRequired" onchange="toggleInterfacesStabilization()">
                                    <option value="no">No</option>
                                    <option value="yes">Yes</option>
                                 </select>
                              </td>
                           </tr>
                           <tr id="interfacesBlock" style="display:none;">
                              <td colspan="2">
                                 <div style="display:flex; justify-content:space-between; align-items:center; gap:10px; margin:6px 0 10px 0;">
                                    <div style="font-size:12px; color:var(--muted);">
                                       Add one row per integration type. Quantity is the number of instances (for example 2 BACS).
                                    </div>
                                    <button type="button" class="calculate-btn csv-btn" style="margin-top:0;" onclick="addInterfaceRow()">Add row</button>
                                 </div>
                                 <table class="interfaces-table" id="interfacesTable" style="margin-top:0;">
                                    <tr>
                                       <td style="font-size:12px; font-weight:700;">Type</td>
                                       <td style="font-size:12px; font-weight:700;">Qty</td>
                                       <td style="font-size:12px; font-weight:700; width:60px;"></td>
                                    </tr>
                                 </table>
                              </td>
                           </tr>
                           <tr>
                              <td>
                                 <span class="label-with-help">
                                 Additional project complexity (in MD)
                                 <span class="help-icon" tabindex="0"
                                    data-tooltip="Stabilization of specific project gaps that involved major customizations from core or have significant impact on main business flows">i</span>
                                 </span>
                              </td>
                              <td><input class="input-sm" type="number" id="additionalProjectComplexity" min="0" value="0" /></td>
                           </tr>
                           <tr>
                              <td>
                                 <span class="label-with-help">
                                 Additional channels (number of distinct channels)
                                 <span class="help-icon" tabindex="0"
									data-tooltip="Enter the number of distinct channels (e.g. SUA, eTrade, Portal). Each channel is counted once.">i</span>
                                 </span>
                              </td>
                              <td><input class="input-sm" type="number" id="channels" min="0" value="0" /></td>
                           </tr>
                           <tr>
                              <td>
                                 <span class="label-with-help">
                                 Merges from BAU branch (count)
                                 <span class="help-icon" tabindex="0"
                                    data-tooltip="Merge code and setup from BAU branch to upgrade branch">i</span>
                                 </span>
                              </td>
                              <td><input class="input-sm" type="number" id="merges" min="0" value="1" /></td>
                           </tr>
                           <tr>
                              <td>
                                 <span class="label-with-help">
                                 Minor core upgrades (count)
                                 <span class="help-icon" tabindex="0"
                                    data-tooltip="Minor core upgrade (for example 18.4.2 to 18.4.3)">i</span>
                                 </span>
                              </td>
                              <td><input class="input-sm" type="number" id="minorUpgrades" min="0" value="0" /></td>
                           </tr>
                           <tr>
                              <td>
                                 <span class="label-with-help">
                                 Solution Design Output(MD)
                                 <span class="help-icon" tabindex="0"
                                    data-tooltip="Implementing requirements that arise from new core functionality conflicting with project requirements">i</span>
                                 </span>
                              </td>
                              <td><input class="input-sm" type="number" id="solutionDesign" min="0" value="0" /></td>
                           </tr>

                           <tr>
                              <td>
                                 <span class="label-with-help">
                                 New core technologies rate (MD per core version)
                                 <span class="help-icon" tabindex="0"
                                    data-tooltip="Rate per core version for adopting new technologies introduced between versions (for example framework changes, security model updates, batch engine changes, major library upgrades). Default is 5 MD per version.">i</span>
                                 </span>
                              </td>
                              <td><input class="input-sm" type="number" id="newTechRate" min="0" step="1" value="5" /></td>
                           </tr>
                           <tr>
                              <td>
                                 <span class="label-with-help">
                                 Performance support required
                                 <span class="help-icon" tabindex="0"
                                    data-tooltip="Enable if performance validation and tuning is required as part of the upgrade.">i</span>
                                 </span>
                              </td>
                              <td style="vertical-align:middle;">
                                 <input class="checkbox-sm" type="checkbox" id="performanceRequired" />
                              </td>
                           </tr>
                           <tr id="performanceMdRow" style="display:none;">
                              <td>
                                 <span class="label-with-help">
                                 Performance effort (MD)
                                 <span class="help-icon" tabindex="0"
                                    data-tooltip="Effort for performance validation and tuning (profiling, measurements, regression checks). Default is 10 MD.">i</span>
                                 </span>
                              </td>
                              <td><input class="input-sm" type="number" id="performanceMd" min="0" value="10" /></td>
                           </tr>
                        </table>
                     </div>
                  
<div id="step2ActionsBar" style="margin-top:18px; display:flex; justify-content:center;">
  <button type="button" class="calculate-btn" id="calculateEffortBtnStep2">
    Calculate effort
  </button>
</div>


                     </div>
				  </div>
                  


               </div>
               
                   
    <!-- Results -->
               <div id="resultsSection" style="display:none;">
                  <div class="results">
				  
				       <div id="detailedBreakdownSection" style="margin-top: 22px;">
  <div style="font-weight: 700; color: var(--brand-navy-2); padding: 10px; background: #f8f9fa; border-radius: 8px;">Editable task breakdown</div>
<table class="detailed-table" id="detailedTable" style="margin-top: 15px;">
                           <thead>
                              <tr>
                                  <th>Phase</th>
                                  <th>Sub phase</th>
                                  <th>Work Items</th>
                                  <th>Qty</th>
                                  <th>Rate</th>
                                  <th>Base MD</th>
                                  <th>Override</th>
                                  <th>Override MD</th>
                                  <th>Notes and assumptions</th>
                                  <th>Total in MD</th></tr>
                           </thead>
                           <tbody></tbody>
                        </table>
                     </div>
                     <h3 style="color:var(--text); margin-bottom: 12px;">Estimation Results</h3>

                     <div class="summary-tiles" id="summaryTiles" aria-label="Executive summary">
                        <div class="summary-tile">
                           <div class="label">Total effort</div>
                           <div class="value" id="tileTotal">-</div>
                           <div class="hint">MD (incl. buffer)</div>
                        </div>
                        <div class="summary-tile">
                           <div class="label">Build and System test</div>
                           <div class="value" id="tileBuild">-</div>
                           <div class="hint">MD</div>
                        </div>
                        <div class="summary-tile">
                           <div class="label">Customer testing</div>
                           <div class="value" id="tileCustomer">-</div>
                           <div class="hint">MD</div>
                        </div>
                        <div class="summary-tile">
                           <div class="label">Global buffer</div>
                           <div class="value" id="tileBufferMd">-</div>
                           <div class="hint">MD</div>
                        </div>
                     </div>

                     <div class="total-result" id="totalEffort"></div>
                     <table>
                        <thead>
                           <tr>
                              <th>Phase</th>
                              <th>Effort (in MD)</th>
                           </tr>
                        </thead>
                        <tbody id="phaseSummary"></tbody>
                     </table>
                     
                     <div id="executiveSummary" class="note" style="margin-top:10px; margin-bottom:10px; display:none;"></div>

<div id="ganttCard" class="section-card" style="margin-top:12px; display:none;">
  <div class="section-title">
    <h4>Gantt - illustrative milestones</h4>
    <span class="badge badge-auto">Illustrative</span>
  </div>

  <p class="section-hint">
    This is a basic, sequential timeline generated from the detailed breakdown totals. It is meant for illustration, not a real project plan.
  </p>

  <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:flex-end; margin-bottom:10px;">
    <div style="min-width:170px;">
      <label for="ganttStartDate">Start date</label>
      <input class="input-sm" type="date" id="ganttStartDate" />
    </div>

    <div style="min-width:170px;">
      <label for="ganttMdPerWeek">Capacity (MD per week)</label>
      <input class="input-sm" type="number" id="ganttMdPerWeek" min="1" step="1" value="25" />
      <div class="muted">Used to convert MD to calendar duration (Mon-Fri).</div>
    </div>

    <div style="min-width:170px;">
      <label for="ganttGroupBy">Group by</label>
      <select class="input-sm" id="ganttGroupBy">
        <option value="phase" selected>Phase</option>
        <option value="subPhase">Sub phase</option>
      </select>
    </div>
	
	 <div style="min-width:230px;">
      <label for="ganttCountries">Holiday calendars (optional)</label>
      <select class="input-sm" id="ganttCountries" multiple size="4" style="height:auto;">
        <option value="IN">India</option>
        <option value="PL">Poland</option>
        <option value="DE">Germany</option>
        <option value="IL">Israel</option>
      </select>
      <div class="muted">Use Ctrl/Cmd + click for multi-select. Public holidays + local weekends are skipped.</div>
    </div>

    <div style="margin-left:auto; display:flex; gap:10px; flex-wrap:wrap;">
      <button id="renderGanttBtn" type="button" class="calculate-btn csv-btn">Build Gantt Chart</button>
      <button id="exportGanttPngBtn" type="button" class="calculate-btn csv-btn">Export Gantt as PNG</button>
    </div>
  </div>

  <div id="ganttSvgWrap" style="border:1px solid var(--border); border-radius:8px; background:#fff; padding:10px; overflow:auto;"></div>
</div>
                     
<div style="text-align:center; display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
  <button class="calculate-btn csv-btn" type="button" id="exportJsonBtnResults">Export to JSON</button>
  <button class="calculate-btn csv-btn" type="button" id="importJsonBtnResults">Import JSON</button>
  <button id="generateGanttBtn" type="button" class="calculate-btn csv-btn">Generate Gantt</button>
    <button id="downloadManagerExcelBtn" type="button" class="calculate-btn csv-btn" onclick="downloadManagerExportCsv()">Download Full Report (CSV for Excel)</button>
  <button id="downloadJiraCsvBtn" type="button" class="calculate-btn csv-btn">Download Jira Import CSV</button>
  <button id="jiraHelpBtn" type="button" class="calculate-btn csv-btn">How to Import into Jira</button>
</div>
<div class="muted" style="text-align:center; margin-top:8px;">A .json file is a plain data file that stores your estimate so you can save it and load it later.</div>

                  </div>
               </div>
            </div>
            <script>
window.el = window.el || function(id){ return document.getElementById(id); };


               const typeNames = {
               major: "Major - Big Bang upgrade (2 core versions) and up",
               annual: "Continuous upgrade - Annual (1 core version)",
               quarterly: "Continuous upgrade - Quarterly"
               };
               
               
               
               
               const state = {
               upgradeType: "",
               coreVersionsCount: 0,
               risk: {
                 globalBufferPct: 0,
                 bufferReason: "",
                 rowBufferPctById: {}
               },
               overrides: {
                 enabledById: {},
                 mdById: {},
                 notesById: {}
               },
               manualTasks: [],
               lastCalc: null
               };
			   
			   window.state = state;

               function jsonClone(value){
                 try{ return JSON.parse(JSON.stringify(value)); }catch(_e){ return null; }
               }

               function collectDomFormValues(){
                 const out = {};
                 const elements = document.querySelectorAll("input[id], select[id], textarea[id]");
                 elements.forEach((el) => {
                   if(!el || !el.id) return;
                   const tag = String(el.tagName || "").toLowerCase();
                   const type = String(el.type || "").toLowerCase();
                   if(type === "file" || type === "button" || type === "submit" || type === "reset") return;

                   if(type === "checkbox" || type === "radio"){
                     out[el.id] = !!el.checked;
                     return;
                   }
                   out[el.id] = (tag === "select") ? String(el.value || "") : (el.value ?? "");
                 });
                 return out;
               }

               function applyDomFormValues(values){
                 if(!values || typeof values !== "object") return;
                 Object.keys(values).forEach((id) => {
                   const el = document.getElementById(id);
                   if(!el) return;

                   const type = String(el.type || "").toLowerCase();
                   if(type === "checkbox" || type === "radio"){
                     el.checked = !!values[id];
                   } else {
                     el.value = values[id] == null ? "" : String(values[id]);
                   }

                   el.dispatchEvent(new Event("input", { bubbles: true }));
                   el.dispatchEvent(new Event("change", { bubbles: true }));
                 });
               }

               function buildJsonSnapshot(){
			   if(typeof readRiskInputsToState === "function"){
                   try{ readRiskInputsToState(); }catch(_e){}
                 }

                 const view = (typeof getCurrentView === "function") ? getCurrentView() : "step1";
                 return {
                   schemaVersion: 1,
                   exportedAt: new Date().toISOString(),
                   view,
                   state: jsonClone(state) || {},
                   domValues: collectDomFormValues(),
				   interfacesRows: (typeof collectInterfacesState === "function") ? collectInterfacesState() : [],
                   techImpactRows: (typeof collectTechImpactState === "function") ? collectTechImpactState() : [],
                   autoCounts: jsonClone(window.autoCounts || null),
                   autoDetails: jsonClone(window.autoDetails || null)
                 };
               }

               function downloadJsonSnapshot(){
                 const payload = buildJsonSnapshot();
                 const json = JSON.stringify(payload, null, 2);
                 const blob = new Blob([json], { type: "application/json;charset=utf-8" });
                 const link = document.createElement("a");
                 link.href = URL.createObjectURL(blob);
                 link.download = "core_upgrade_estimate_" + new Date().toISOString().slice(0, 10) + ".json";
                 document.body.appendChild(link);
                 link.click();
                 document.body.removeChild(link);
                 setTimeout(() => URL.revokeObjectURL(link.href), 500);
               }

               function mergeImportedState(importedState){
                 if(!importedState || typeof importedState !== "object") return;
                 Object.keys(state).forEach((k) => { delete state[k]; });
                 Object.assign(state, importedState);

                 if(!state.risk || typeof state.risk !== "object") state.risk = { globalBufferMode: "pct", globalBufferPct: 0, globalBufferMd: 0, bufferReason: "", rowBufferPctById: {} };
                 if(!state.risk.globalBufferMode) state.risk.globalBufferMode = "pct";
                 if(!Number.isFinite(Number(state.risk.globalBufferMd))) state.risk.globalBufferMd = 0;
                 if(!state.overrides || typeof state.overrides !== "object") state.overrides = { enabledById: {}, mdById: {}, notesById: {} };
                 if(!Array.isArray(state.manualTasks)) state.manualTasks = [];
               }

               function applyImportedSnapshot(payload){
                 const incoming = (payload && typeof payload === "object") ? payload : {};
                 const importedState = (incoming.state && typeof incoming.state === "object") ? incoming.state : incoming;
                 mergeImportedState(importedState);

                 if(incoming.autoCounts && typeof incoming.autoCounts === "object") window.autoCounts = incoming.autoCounts;
                 if(incoming.autoDetails && typeof incoming.autoDetails === "object") window.autoDetails = incoming.autoDetails;

                 if(typeof updateToOptionsFromFromSelection === "function") updateToOptionsFromFromSelection();
                 applyDomFormValues(incoming.domValues || {});
				 if(typeof applyInterfacesState === "function") applyInterfacesState(incoming.interfacesRows || []);
                 if(typeof updateUpgradeScopeFromRange === "function") updateUpgradeScopeFromRange();
				 if(typeof updateTechDashboard === "function") updateTechDashboard();
                 if(typeof applyTechImpactState === "function") applyTechImpactState(incoming.techImpactRows || []);
                 if(typeof wireManualTasks === "function") wireManualTasks();

                 const view = String(incoming.view || "step2");
                 if(view === "results"){
                   if(typeof showStep === "function") showStep(2);
                   if(typeof calculateEffort === "function") calculateEffort();
                 } else if(view === "step2"){
                   if(typeof showStep === "function") showStep(2);
                 } else {
                   if(typeof showStep === "function") showStep(1);
                 }
				 
				 // Some controls (for example Global Buffer) are rendered during results refresh.
                 // Reapply captured DOM values after view restoration to avoid being overwritten.
                 applyDomFormValues(incoming.domValues || {});

                 // Re-applying generic DOM values can trigger dependent re-renders (core range changes,
                 // interfaces toggle, etc.) that recreate UI rows and wipe previously-restored values.
                 // Restore specialized state again after that final DOM replay.
                 if(typeof updateTechDashboard === "function") updateTechDashboard();
                 if(typeof applyTechImpactState === "function") applyTechImpactState(incoming.techImpactRows || []);
                 if(typeof applyInterfacesState === "function") applyInterfacesState(incoming.interfacesRows || []);

                 if(typeof readRiskInputsToState === "function"){
                   try{ readRiskInputsToState(); }catch(_e){}
                 }
                 if(typeof applyOverridesAndRefresh === "function" && String(incoming.view || "") === "results"){
                   try{ applyOverridesAndRefresh(); }catch(_e){}
                 }
                 if(typeof window.__decorateDetailedBreakdown === "function"){
                   try{ window.__decorateDetailedBreakdown(); }catch(_e){}
                 }
               }

               function importJsonFromFile(file){
                 if(!file) return;
                 const reader = new FileReader();
                 reader.onload = function(evt){
                   try{
                     const text = String(evt && evt.target ? (evt.target.result || "") : "");
                     const payload = JSON.parse(text);
                     applyImportedSnapshot(payload);
                     alert("JSON import completed.");
                   }catch(err){
                     alert("JSON import failed: " + (err && err.message ? err.message : String(err)));
                   }
                 };
                 reader.readAsText(file);
               }

               function wireJsonImportExport(){
                 const exportBtn = document.getElementById("exportJsonBtnResults");
                 const importBtnStep1 = document.getElementById("importJsonBtnStep1");
                 const importBtnResults = document.getElementById("importJsonBtnResults");
                 const importInput = document.getElementById("importJsonFile");

                 if(exportBtn && !exportBtn.__jsonWired){
                   exportBtn.__jsonWired = true;
                   exportBtn.addEventListener("click", function(){
                     try{ downloadJsonSnapshot(); }
                     catch(err){ alert("JSON export failed: " + (err && err.message ? err.message : String(err))); }
                   });
                 }

                 const openPicker = function(){ if(importInput) importInput.click(); };

                 if(importBtnStep1 && !importBtnStep1.__jsonWired){
                   importBtnStep1.__jsonWired = true;
                   importBtnStep1.addEventListener("click", openPicker);
                 }
                 if(importBtnResults && !importBtnResults.__jsonWired){
                   importBtnResults.__jsonWired = true;
                   importBtnResults.addEventListener("click", openPicker);
                 }
                 if(importInput && !importInput.__jsonWired){
                   importInput.__jsonWired = true;
                   importInput.addEventListener("change", function(e){
                     const file = e && e.target && e.target.files ? e.target.files[0] : null;
                     importJsonFromFile(file);
                     e.target.value = "";
                   });
                 }
               }

const CORE_TECH_STACK = {
  core16_0: {
    java: "Java 8 (Oracle JDK / OpenJDK)",
    database: "Oracle 12.2 / SQL Server 2017 / DB2 10.5",
    appServer: "WebLogic 12.2.x / JBoss EAP 7.2 / WebSphere 9",
    kubernetes: "-",
    openshift: "-",
    baseImage: "-",
    elastic: "6.1",
    kibana: "6.1",
    fluentd: "-",
    ingressNginx: "-",
    artemis: "-",
    activemq: "-",
    keycloak: "-",
    camunda: "-",
    jasperReports: "JS 6.x",
    couchbase: "-",
    springBoot: "-",
    cdc: "-",
    complexityMultiplier: 1.0,
    platform: "Traditional (VM / App Server)"
  },

  core17_0: {
    java: "Oracle JDK 11.0 / OpenJDK 11.0",
    database: "Oracle 19.4.x / SQL Server 2019 / DB2 10.5",
    appServer: "WebLogic 14.1 / JBoss EAP 7.3 / WebSphere 9 / WildFly 18.x (community)",
    kubernetes: "-",
    openshift: "-",
    baseImage: "-",
    elastic: "7.10",
    kibana: "7.10",
    logstash: "7.10",
    fluentd: "-",
    ingressNginx: "-",
    artemis: "-",
    activemq: "-",
    keycloak: "-",
    camunda: "-",
    jasperReports: "JS 6.x",
    couchbase: "-",
    springBoot: "-",
    cdc: "-",
    complexityMultiplier: 1.05,
    platform: "Traditional (VM / App Server)"
  },

  core18_0: {
    java: "Java 11 (monolith) / Java 17 (microservices)",
    database: "Oracle 19c / SQL Server 2019",
    appServer: "WildFly 18.x",
    kubernetes: "1.21+",
    openshift: "-",
    baseImage: "Debian Linux",
    elastic: "7.14",
    kibana: "7.14",
    fluentd: "1.14.2",
    ingressNginx: "Nginx",
    artemis: "ActiveMQ 5.11 / Artemis 2.23.0",
    activemq: "-",
    keycloak: "18.0.0",
    camunda: "7",
    jasperReports: "JS 6.x",
    couchbase: "7.0.x",
    springBoot: "-",
    cdc: "-",
    complexityMultiplier: 1.1,
    platform: "Kubernetes"
  },

  core19_1: {
    java: "OpenJDK 11",
    database: "Oracle 19 / SQL Server 2019/2022",
    appServer: "WildFly 18 (containers)",
    kubernetes: "1.26",
    openshift: "4.12.x",
    baseImage: "RedHat UBI (OpenShift)",
    elastic: "8.x",
    kibana: "8.x",
    fluentd: "1.15",
    ingressNginx: "4.10",
    activemq: "AMQ 5.18",
    artemis: "-",
    keycloak: "21.x",
    camunda: "N/A",
    jasperReports: "8.2",
    couchbase: "7.1.4+",
    springBoot: "Spring Boot 3.x (running Tomcat)",
    nodejs: "N/A",
    cdc: "Debezium 2.4.x",
    complexityMultiplier: 1.2,
    platform: "OpenShift"
  },

  core19_2: {
    java: "OpenJDK 17",
    database: "Oracle 19",
    appServer: "WildFly 30",
    kubernetes: "1.26",
    openshift: "4.12.x",
    baseImage: "RedHat UBI (Linux)",
    elastic: "8.x",
    kibana: "8.x",
    fluentd: "1.15",
    ingressNginx: "4.10.x",
    artemis: "2.31.0",
    keycloak: "21.x",
    camunda: "7.20",
    jasperReports: "8.2",
    couchbase: "7.1.4+",
    springBoot: "3.x",
    complexityMultiplier: 1.25,
    platform: "OpenShift"
  },

  core20_2: {
    java: "OpenJDK 17.0",
    database: "Oracle 19 / SQL Server 2022",
    appServer: "WildFly 32.x",
    kubernetes: "1.27.3",
    openshift: "4.12.x",
    baseImage: "RedHat UBI (Linux)",
    elastic: "8.x",
    kibana: "8.x",
    fluentd: "1.15",
    ingressNginx: "4.10.x",
    artemis: "2.33.0",
    keycloak: "24.x",
    camunda: "7.20",
    jasperReports: "8.2",
    couchbase: "7.1.4",
    springBoot: "3.2.x (running Tomcat)",
    cdc: "Debezium 3.0.7",
    complexityMultiplier: 1.3,
    platform: "OpenShift"
  },

  core21_3: {
    java: "OpenJDK 21",
    database: "Oracle 19",
    appServer: "WildFly 34.0.1.Final",
    kubernetes: "1.33 (latest)",
    openshift: "4.18.x",
    baseImage: "RedHat UBI 9.x",
    elastic: "8.17",
    kibana: "8.17",
    fluentd: "1.18.0",
    ingressNginx: "4.12.x",
    artemis: "2.41",
    keycloak: "26.1.1",
    camunda: "7.20 (planned replacement: Flowable)",
    jasperReports: "9.0.0003",
    couchbase: "7.6.x",
    springBoot: "3.4.4 / 3.5.4 (Evergreen)",
    complexityMultiplier: 1.5,
    platform: "OpenShift"
  }
};

 window.CORE_VERSIONS = [
  { key: "core16_0", label: "core 16.0" },
  { key: "core17_0", label: "core 17.0" },
  { key: "core18_0", label: "core 18.0" },
  { key: "core19_1", label: "core 19.1" },
  { key: "core19_2", label: "core 19.2" },
  { key: "core20_2", label: "core 20.2" },
  { key: "core21_3", label: "core 21.3" }
];

function setSelectOptions(selectEl, options, keepValue) {
  if (!selectEl) return;
  const current = keepValue ?? selectEl.value;
  selectEl.innerHTML = "";
  const opt0 = document.createElement("option");
  opt0.value = "";
  opt0.textContent = "Select...";
  selectEl.appendChild(opt0);

  options.forEach(o => {
    const opt = document.createElement("option");
    opt.value = o.key;
    opt.textContent = o.label;
    selectEl.appendChild(opt);
  });

  if (current && options.some(o => o.key === current)) {
    selectEl.value = current;
  } else {
    selectEl.value = "";
  }
}

function updateUpgradeScopeFromRange(){
  const fromSel = document.getElementById("coreFrom");
  const toSel = document.getElementById("coreTo");
  if(!fromSel || !toSel) return;

  const fromKey = fromSel.value;
  const toKey = toSel.value;

  const fromIdx = window.CORE_VERSIONS.findIndex(v => v.key === fromKey);
  const toIdx = window.CORE_VERSIONS.findIndex(v => v.key === toKey);

  // coreVersionsCount = number of core versions jumped (indexes delta)
  if(fromIdx >= 0 && toIdx >= 0 && toIdx > fromIdx){
    state.coreVersionsCount = (toIdx - fromIdx);
  } else {
    state.coreVersionsCount = 0;
  }

  // Upgrade Scope Summary (labels, not keys)
  const tbody = document.getElementById("upgradeScopeTbody");
  if(tbody){
    const fromLabel = (fromSel.options[fromSel.selectedIndex]?.textContent || fromKey || "-").trim();
    const toLabel = (toSel.options[toSel.selectedIndex]?.textContent || toKey || "-").trim();

    const maj = (k) => {
      const s = String(k||"");
      const m = s.match(/core\s*([0-9]+)/i) || s.match(/core([0-9]+)/i);
      return m ? parseInt(m[1], 10) : NaN;
    };
    const majorDelta = (Number.isFinite(maj(fromKey)) && Number.isFinite(maj(toKey))) ? Math.max(0, maj(toKey) - maj(fromKey)) : 0;

    tbody.innerHTML = ""
      + "<tr><td>From</td><td><strong>" + escapeHtml(fromLabel) + "</strong></td></tr>"
      + "<tr><td>To</td><td><strong>" + escapeHtml(toLabel) + "</strong></td></tr>"
      + "<tr><td>Major version delta</td><td><strong>" + majorDelta + "</strong></td></tr>";
  }

  if(typeof updateTechDashboard === "function") updateTechDashboard();
}

function updateToOptionsFromFromSelection() {
  const fromSel = document.getElementById("coreFrom");
  const toSel = document.getElementById("coreTo");
  if(!fromSel || !toSel) return;

  const fromKey = fromSel.value;
  const fromIdx = window.CORE_VERSIONS.findIndex(v => v.key === fromKey);

  const prevTo = toSel.value;

  toSel.innerHTML = "";

  // Only allow TO versions strictly AFTER FROM
  const allowed = (fromIdx >= 0)
    ? window.CORE_VERSIONS.slice(fromIdx + 1)
    : window.CORE_VERSIONS.slice();

  allowed.forEach(o => {
    const opt = document.createElement("option");
    opt.value = o.key;
    opt.textContent = o.label;
    toSel.appendChild(opt);
  });

  // Keep previous To if still valid, otherwise keep empty to enforce explicit user selection
  const stillValid = Array.from(toSel.options).some(o => o.value === prevTo);
    toSel.value = stillValid ? prevTo : "";
}

function escapeHtml(s) {
  const str = (s == null) ? "" : String(s);
  return str
    .replace(/&/g, "&amp;")
    .replace(/</g, "&lt;")
    .replace(/>/g, "&gt;")
    .replace(/"/g, "&quot;")
    .replace(/'/g, "&#039;");
}



function getSelectedOptionText(selectId){
  const sel = document.getElementById(selectId);
  const opt = sel && sel.selectedOptions && sel.selectedOptions[0];
  return opt ? opt.textContent.trim() : (sel ? String(sel.value || "") : "");
}

// updateTechDashboard removed (unused)


function stripHelpIconSuffix(s) {
  const t = String(s ?? "");
  // Help icon can be concatenated as a trailing 'i' in some UI innerText flows
  return t.replace(/([A-Za-z0-9])i\s*$/, "$1").trim();
}


function excelSafeText(s) {
  const t = s === null || s === undefined ? "" : String(s);
  // Prevent Excel from treating values as formulas
  if (/^[=+\-@]/.test(t)) return "'" + t;
  return t;
}

function csvEscape(value) {
  const v = value === null || value === undefined ? "" : String(value);
  let needsQuotes = false;
  for (let i = 0; i < v.length; i++) {
    const ch = v.charCodeAt(i);
    if (v[i] === '"' || v[i] === ',' || ch === 10 || ch === 13) {
      needsQuotes = true;
      break;
    }
  }
  const escaped = v.split('"').join('""');
  return needsQuotes ? '"' + escaped + '"' : escaped;
}

function getDetailedTableRowsForManagerExport() {
  const tbody = document.querySelector("#detailedTable tbody");
  if (!tbody) throw new Error("Detailed breakdown table not found.");

  const rows = [];
  const trs = Array.from(tbody.querySelectorAll("tr"));
  trs.forEach((tr) => {
    if (tr.classList.contains("table-section-header")) return;

    const tds = Array.from(tr.querySelectorAll("td"));
    if (!tds.length) return;

    const getCellText = (cell) => {
      if (!cell) return "";
      const clone = cell.cloneNode(true);
      clone.querySelectorAll(".help-icon, .row-add-btn, .row-del-btn, button, input, textarea, select").forEach((n) => n.remove());
      return String(clone.innerText || "").replace(/\s+/g, " ").trim();
    };

    const getInputValue = (cell) => {
      if (!cell) return "";
      const control = cell.querySelector("input, textarea, select");
      return control ? String(control.value || "").trim() : "";
    };

    rows.push({
      phase: getInputValue(tds[0]) || getCellText(tds[0]),
      subPhase: getInputValue(tds[1]) || getCellText(tds[1]),
      workItem: getInputValue(tds[2]) || getCellText(tds[2]),
      qty: getInputValue(tds[3]) || getCellText(tds[3]),
      rate: getInputValue(tds[4]) || getCellText(tds[4]),
      baseMd: getInputValue(tds[5]) || getCellText(tds[5]),
      overrideEnabled: tds[6] && tds[6].querySelector('input[type="checkbox"]') ? (tds[6].querySelector('input[type="checkbox"]').checked ? "Yes" : "No") : "",
      overrideMd: getInputValue(tds[7]) || getCellText(tds[7]),
      notes: getInputValue(tds[8]) || getCellText(tds[8]),
      totalMd: getCellText(tds[9]) || getInputValue(tds[9])
    });
  });

  if (!rows.length) {
    throw new Error("No rows to export. Please calculate effort first.");
  }

  return rows;
}

function downloadManagerExportCsv() {
  try {
    const rows = getDetailedTableRowsForManagerExport();
    const header = [
      "Upgrade type",
      "Phase",
      "Sub phase",
      "Work item",
      "Qty",
      "Rate",
      "Base MD",
      "Override",
      "Override MD",
      "Notes",
      "Total MD"
    ];

    const upgradeType = (state.lastCalc && state.lastCalc.upgradeTypeLabel) || "";
    const csvLines = [header.map(csvEscape).join(",")];

    rows.forEach((row) => {
      csvLines.push([
        excelSafeText(upgradeType),
        excelSafeText(row.phase),
        excelSafeText(row.subPhase),
        excelSafeText(row.workItem),
        excelSafeText(row.qty),
        excelSafeText(row.rate),
        excelSafeText(row.baseMd),
        excelSafeText(row.overrideEnabled),
        excelSafeText(row.overrideMd),
        excelSafeText(row.notes),
        excelSafeText(row.totalMd)
      ].map(csvEscape).join(","));
    });

    const blob = new Blob([csvLines.join("\n")], { type: "text/csv;charset=utf-8;" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = `Manager_Report_${new Date().toISOString().slice(0, 10)}.csv`;

    link.style.display = "none";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);

    setTimeout(() => {
      try { URL.revokeObjectURL(link.href); } catch (e) {}
    }, 0);
  } catch (err) {
    console.error(err);
    alert("Manager export failed: " + (err && err.message ? err.message : String(err)));
  }
}



function buildDescription(ctx) {
  // Minimal Jira description builder. Keep simple and stable.
  const parts = [];
  const add = (label, val) => {
    if (val === null || val === undefined) return;
    const s = String(val).trim();
    if (!s) return;
    parts.push(label + ": " + s);
  };

  add("Phase", ctx.phase);
  add("Sub phase", ctx.subPhase);
  add("Work item", ctx.workItem);
  if (ctx.qty !== undefined) add("Qty", ctx.qty);
  if (ctx.rate !== undefined) add("Rate", ctx.rate);
  if (ctx.baseMd !== undefined) add("Base MD", ctx.baseMd);
  if (ctx.overrideEnabled) {
    add("Override", "Yes");
    add("Override MD", ctx.overrideMdVal);
  }
  add("Notes", ctx.notes);
  if (ctx.totalMd !== undefined) add("Total MD", ctx.totalMd);
  return parts.join("\n");
}


function getDetailedRowModelForCsv(tr) {
  const isUser = tr && tr.getAttribute && tr.getAttribute("data-user-added") === "1";
  const isTotalish = (tr?.textContent || "").includes("TOTAL DEV EFFORT") || (tr?.textContent || "").includes("Total (incl. buffer)") || (tr?.textContent || "").includes("Global Buffer");
  if (!tr || isTotalish) return null;

  if (isUser) {
    const val = (sel) => (tr.querySelector(sel)?.value ?? "").trim();
    const num = (sel) => {
      const v = parseFloat(tr.querySelector(sel)?.value);
      return Number.isFinite(v) ? v : 0;
    };
    const isOverride = !!tr.querySelector('[data-user-override="1"]')?.checked;
    const overrideRaw = parseFloat(tr.querySelector('[data-user-override-md="1"]')?.value);
    const overrideMd = Number.isFinite(overrideRaw) ? overrideRaw : null;
    const baseMd = num('[data-user-base-md="1"]');
    const totalMd = (isOverride && overrideMd !== null) ? overrideMd : baseMd;

    return {
      phase: val('[data-user-phase="1"]'),
      subPhase: val('[data-user-sub="1"]'),
      workItem: val('[data-user-work="1"]'),
      notes: val('[data-user-notes="1"]'),
      totalMd: totalMd
    };
  }

  // Non-user rows: read visible text from cells (without buttons/icons)
  const tds = Array.from(tr.querySelectorAll("td"));
  const cleanCell = (td) => {
    const clone = td.cloneNode(true);
    clone.querySelectorAll(".help-icon, .row-add-btn, .row-del-btn, button").forEach((n) => n.remove());
    return (clone.textContent || "").replace(/\s+/g, " ").trim();
  };

  return {
    phase: cleanCell(tds[0] || document.createElement("td")),
    subPhase: cleanCell(tds[1] || document.createElement("td")),
    workItem: cleanCell(tds[2] || document.createElement("td")),
    notes: "", // notes are input placeholders, not required in summary
    totalMd: parseFloat(cleanCell(tds[9] || document.createElement("td"))) || 0
  };
}

function generateCSV(parentKey) {
  try {
    const defaults = window.jiraDefaults || {
      components: "Core Upgrade",
      affectsVersions: "Not Relevant",
      sapiensProduct: "IDIT",
      sapiensSeveritySla: "",
      projectPhase: "",
      competenceCenter: "Development"
    };

    // Collect rows from the on-screen editable breakdown table so manual edits are preserved.
    const tbody = document.querySelector("#detailedTable tbody");
    if (!tbody) throw new Error("Detailed breakdown table not found.");

    const isSummaryLike = (t) => {
      const s = String(t || "").trim().toLowerCase();
      return (
        s.includes("total dev effort") ||
        s.startsWith("global buffer") ||
        s.startsWith("total (incl. buffer)") ||
        s === ""
      );
    };

    const getCellTextClean = (cell) => {
      if (!cell) return "";
      const clone = cell.cloneNode(true);
      clone.querySelectorAll(".help-icon, .row-add-btn, .row-del-btn, button[data-add-row=\"1\"], button[data-del-row=\"1\"]").forEach((n) => n.remove());
      return String(clone.innerText || "").replace(/\s+/g, " ").trim();
    };

    const getInputVal = (cell, selector) => {
      const el = selector ? cell.querySelector(selector) : cell.querySelector("input, textarea, select");
      return el ? String(el.value || "").trim() : "";
    };

    const getCheckbox = (cell, selector) => {
      const el = selector ? cell.querySelector(selector) : cell.querySelector('input[type="checkbox"]');
      return !!(el && el.checked);
    };

    const safeNum = (v, fallback = 0) => {
      const n = parseFloat(String(v).replace(",", "."));
      return Number.isFinite(n) ? n : fallback;
    };

    const safeInt = (v, fallback = 0) => {
      const n = parseInt(String(v), 10);
      return Number.isFinite(n) ? n : fallback;
    };

    const trs = Array.from(tbody.querySelectorAll("tr"));
    const dataRows = trs.filter((tr) => !tr.classList.contains("table-section-header"));

    const csvLines = [];
    // Header
    csvLines.push([
      "Issue Type",
      "Summary",
      "Description",
      "Parent",
      "Components",
      "Affects versions",
      "Custom field (Sapiens Product)",
      "Competence Center",
	   "Dev MD Estimation (Final)"
    ].map(csvEscape).join(","));

    let exportedCount = 0;

    dataRows.forEach((tr) => {
      const tds = Array.from(tr.querySelectorAll("td"));
      if (tds.length < 6) return;

      // Column mapping in the UI table:
      // 0 Phase, 1 Sub phase, 2 Work Items, 3 Qty, 4 Rate, 5 Base MD, 6 Override, 7 Override MD, 8 Notes, 9 Total
      const isUserAdded = tr.getAttribute("data-user-added") === "1";

      // Phase/Sub phase can be read-only text OR inputs (user-added rows)
      const phase = stripHelpIconSuffix(
        getInputVal(tds[0]) || getCellTextClean(tds[0])
      );
      const subPhase = stripHelpIconSuffix(
        getInputVal(tds[1]) || getCellTextClean(tds[1])
      );

      // Work item can be text or input (user-added rows)
      const workItem = stripHelpIconSuffix(
        getInputVal(tds[2]) || getCellTextClean(tds[2])
      );

      // Skip summary rows (TOTAL/BUFFER/etc) - but do not treat empty cells as summary for user-added rows
      if (!isUserAdded && (isSummaryLike(phase) || isSummaryLike(workItem))) return;
      if (isUserAdded && !String(workItem || "").trim()) return;

      const qty = safeInt(getInputVal(tds[3]) || getCellTextClean(tds[3]), 1);
      const rate = getInputVal(tds[4]) || getCellTextClean(tds[4]);
      const baseMd = safeNum(getInputVal(tds[5]) || getCellTextClean(tds[5]), 0);

      const overrideEnabled = getCheckbox(tds[6], 'input[type="checkbox"]');
      const overrideMdValRaw = getInputVal(tds[7]) || getCellTextClean(tds[7]);
      const overrideMdVal = overrideEnabled ? safeNum(overrideMdValRaw, baseMd) : null;

      const notes = getInputVal(tds[8]) || getCellTextClean(tds[8]);

      const totalFromCell = safeNum(getCellTextClean(tds[9]), NaN);
      const totalMd = Number.isFinite(totalFromCell)
        ? totalFromCell
        : safeNum((overrideEnabled ? overrideMdVal : baseMd), 0);

      

     const summaryParts = [phase, subPhase, workItem]
        .map((v) => stripHelpIconSuffix(v))
        .map((v) => String(v || " ").trim())
        .filter(Boolean);
      const summary = summaryParts.join("	") || "Sub-task";

      const notesClean = String(notes || " ").trim();
      const description = notesClean ? `${summary}
${notesClean}` : summary;

      const row = [
        "Sub-task",
        excelSafeText(summary),
        excelSafeText(description),
        parentKey,
        defaults.components,
        defaults.affectsVersions,
        defaults.sapiensProduct,
        defaults.competenceCenter,
        totalMd
      ];

      csvLines.push(row.map(csvEscape).join(","));
      exportedCount += 1;
    });

    if (exportedCount === 0) {
      throw new Error("No rows to export. Make sure the breakdown table has tasks.");
    }

    const csvContent = csvLines.join("\n");
    const blob = new Blob([csvContent], { type: "text/csv;charset=utf-8;" });
    const link = document.createElement("a");
    link.href = URL.createObjectURL(blob);
    link.download = `JiraImport_SubTasks_${new Date().toISOString().slice(0, 10)}.csv`;

    link.style.display = "none";
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    setTimeout(() => {
      try { URL.revokeObjectURL(link.href); } catch(e) {}
    }, 0);
  } catch (err) {
    console.error(err);
    alert("CSV export failed: " + (err && err.message ? err.message : String(err)));
  }
}

               
			   
               function toggleInterfacesStabilization(){
               const required = document.getElementById("interfacesRequired").value;
               const block = document.getElementById("interfacesBlock");
               
               if(required === "yes"){
               block.style.display = "";
               // If no rows yet, add one default row
               const table = document.getElementById("interfacesTable");
               if(table.querySelectorAll("tr.interface-row").length === 0){
                 addInterfaceRow();
               }
               } else {
               block.style.display = "none";
               // remove all rows
               const table = document.getElementById("interfacesTable");
               table.querySelectorAll("tr.interface-row").forEach(r => r.remove());
               }
               }
               
               function addInterfaceRow(){
               const table = document.getElementById("interfacesTable");
               
               const tr = document.createElement("tr");
               tr.className = "interface-row";
               
               tr.innerHTML = `
               <td>
                 <select class="input-sm interface-type">
                   <option value="simple">Simple - outgoing interface (address, Google Maps, risk info)</option>
               <option value="medium">Medium - simple batches, multiple interfaces triggering logic</option>
               <option value="complex">Complex - BACS / heavy batch / payment flows</option>
                 </select>
               </td>
               <td>
<input class="input-sm interface-qty" type="number" min="0" value="1" />
               </td>
               <td style="text-align:center;">
                 <button type="button" class="icon-btn" style="margin:0;" onclick="removeInterfaceRow(this)">X</button>
               </td>
               `;
               
               table.appendChild(tr);
               }
               
               function removeInterfaceRow(btn){
               const tr = btn.closest("tr");
               if(tr) tr.remove();
               
               // If no rows left, keep block open but user can add again
               }
               
               function togglePerformanceSupport(){
  togglePerformanceMdRow();
}

function togglePerformanceMdRow(){
                 const cb = document.getElementById("performanceRequired");
                 const row = document.getElementById("performanceMdRow");
                 if(!cb || !row) return;
                 row.style.display = cb.checked ? "" : "none";
                 if(!cb.checked){
                   const md = document.getElementById("performanceMd");
                   if(md) md.value = 0;
                 }
               }

               // Update UI immediately when toggling performance and auto-recalculate if results are visible
               (function wirePerformanceHandlers(){
  const cb = document.getElementById("performanceRequired");
  if(!cb) return;

  cb.addEventListener("change", function(){
    togglePerformanceMdRow();
    // Do not auto-run calculation here - avoid page jump.
    // User triggers calculation explicitly via Calculate button.
  });

  const md = document.getElementById("performanceMd");
  if(md){
    md.addEventListener("input", function(){
      // Do not auto-run calculation here - avoid page jump.
    });
  }

  // Initialize on load
  togglePerformanceMdRow();
})();
(function wireRiskHandlers(){
                 const pct = document.getElementById("globalBufferPct");
                 const reason = document.getElementById("bufferReason");

                 if(pct){
                   pct.addEventListener("input", function(){
                     readRiskInputsToState();
                     if(isResultsVisible()){
                       applyOverridesAndRefresh();
                     }
                   });
                 }

                 if(reason){
                   reason.addEventListener("input", function(){
                     readRiskInputsToState();
                     if(isResultsVisible()){
                       applyOverridesAndRefresh();
                     }
                   });
                 }
               })();


               function wireJiraHelpModal(){
                 const btn = document.getElementById("jiraHelpBtn");
                 const modal = document.getElementById("jiraHelpModal");
                 const closeBtn = document.getElementById("closeJiraHelp");
				                  const downloadInstructionsBtn = document.getElementById("downloadJiraInstructionsTxt");
                 if(!btn || !modal || !closeBtn) return;

                 function openModal(){
                   modal.classList.remove("hidden");
                   modal.setAttribute("aria-hidden", "false");
                 }

                 function closeModal(){
                   modal.classList.add("hidden");
                   modal.setAttribute("aria-hidden", "true");
                 }

                 btn.addEventListener("click", openModal);
                 closeBtn.addEventListener("click", closeModal);

                 modal.addEventListener("click", function(e){
                   if(e.target === modal) closeModal();
                 });

                 document.addEventListener("keydown", function(e){
                   if(e.key === "Escape") closeModal();
                 });
				 if(downloadInstructionsBtn){
                   downloadInstructionsBtn.addEventListener("click", function(){
                     const steps = Array.from(modal.querySelectorAll("ol li"))
                       .map(function(li, idx){
                         return (idx + 1) + ". " + String(li.textContent || "").trim();
                       })
                       .filter(Boolean);

                     const lines = ["How to import the CSV into Jira", "", ...steps];
                     const blob = new Blob([lines.join("\n")], { type: "text/plain;charset=utf-8" });
                     const url = URL.createObjectURL(blob);
                     const link = document.createElement("a");

                     link.href = url;
                     link.download = "jira_import_instructions.txt";
                     document.body.appendChild(link);
                     link.click();
                     link.remove();
                     URL.revokeObjectURL(url);
                   });
                 }
               }

               
               function wireJiraParentModal(){
                 const openBtn = document.getElementById("downloadJiraCsvBtn");
                 const modal = document.getElementById("jiraParentModal");
                 const closeBtn = document.getElementById("closeJiraParent");
                 const cancelBtn = document.getElementById("jiraParentCancel");
                 const downloadBtn = document.getElementById("jiraParentDownload");
                 const input = document.getElementById("jiraParentKey");
                 const error = document.getElementById("jiraParentError");

                 if(!openBtn || !modal || !closeBtn || !cancelBtn || !downloadBtn || !input || !error) return;

function normalizeJiraKey(v){
                   return String(v || "").trim().toUpperCase();
                 }
				 
                 function isValidKey(v){
                   return /^[A-Z][A-Z0-9]+-\d+$/.test(normalizeJiraKey(v));
                 }

                 function updateState(){
                   const v = String(input.value || "").trim();
                   const ok = isValidKey(v);
                   downloadBtn.disabled = !ok;
                   error.style.display = ok || v.length === 0 ? "none" : "block";
                 }

                 function openModal(){
                   modal.classList.remove("hidden");
                   modal.setAttribute("aria-hidden", "false");
                   input.focus();
                   updateState();
                 }

                 function closeModal(){
                   modal.classList.add("hidden");
                   modal.setAttribute("aria-hidden", "true");
                 }

                 openBtn.addEventListener("click", function(){
                   if (!window.calculationData) {
                     alert("Please calculate effort first.");
                     return;
                   }
                   openModal();
                 });

                 closeBtn.addEventListener("click", closeModal);
                 cancelBtn.addEventListener("click", closeModal);

                 modal.addEventListener("click", function(e){
                   if(e.target === modal) closeModal();
                 });

                 document.addEventListener("keydown", function(e){
                   if(e.key === "Escape" && !modal.classList.contains("hidden")) closeModal();
                 });

                 input.addEventListener("input", updateState);

                 downloadBtn.addEventListener("click", function(){
                   const v = normalizeJiraKey(input.value);
                   if(!isValidKey(v)) {
                     updateState();
                     return;
                   }
				   input.value = v;
                   closeModal();
                   generateCSV(v);
                 });
               }




// --- Restored core calculation + overrides ---
function applyAutoCountsToInputs(){
  if(!window.autoCounts) return;
  const setNum = (id, v) => {
    const x = document.getElementById(id);
    if(!x) return;
    const n = parseInt(v, 10);
    x.value = Number.isFinite(n) ? String(n) : String(parseInt(x.value, 10) || 0);
  };

  setNum("xmlFiles", window.autoCounts.xmlFiles);
  setNum("jspFiles", window.autoCounts.jspFiles);
  setNum("changedMethods", window.autoCounts.changedMethods);
  setNum("changedQueries", window.autoCounts.changedQueries);
  setNum("sessionBeans", window.autoCounts.sessionBeans);

  // merges field id in this file is likely 'merges' or 'bauMerges' - set both if exist
  if(typeof window.autoCounts.merges !== "undefined"){
    setNum("merges", window.autoCounts.merges);
    setNum("bauMerges", window.autoCounts.merges);
  }
}

function wireOverrideInputs(){
                 // Override checkbox
                 document.querySelectorAll("input[data-override-row]").forEach((cb) => {
                   if(cb.__overrideWired) return;
                   cb.__overrideWired = true;

                   cb.addEventListener("change", () => {
                     const rowId = cb.getAttribute("data-override-row");
                     state.overrides.enabledById[rowId] = !!cb.checked;

                     const mdInp = document.querySelector(`input[data-override-md-row="${rowId}"]`);
                     if(mdInp) mdInp.disabled = !cb.checked;

                     if(isResultsVisible()){
                       applyOverridesAndRefresh();
                     }
                   });
                 });

                 // Override MD input
                 document.querySelectorAll("input[data-override-md-row]").forEach((inp) => {
                   if(inp.__overrideMdWired) return;
                   inp.__overrideMdWired = true;

                   inp.addEventListener("input", () => {
                     const rowId = inp.getAttribute("data-override-md-row");
                     const raw = String(inp.value || "").trim();

                     if(raw === ""){
                       delete state.overrides.mdById[rowId];
                     } else {
                       const v = parseFloat(raw);
                       state.overrides.mdById[rowId] = Number.isFinite(v) ? v : 0;
                     }

                     if(isResultsVisible()){
                       applyOverridesAndRefresh();
                     }
                   });
                 });

                 // Notes and assumptions
                 document.querySelectorAll("input[data-notes-row]").forEach((inp) => {
                   if(inp.__notesWired) return;
                   inp.__notesWired = true;

                   inp.addEventListener("input", () => {
                     const rowId = inp.getAttribute("data-notes-row");
                     state.overrides.notesById[rowId] = String(inp.value || "");

                     const tr = inp.closest("tr");
                     if(tr) tr.setAttribute("data-notes", state.overrides.notesById[rowId]);

                     // totals do not depend on notes, no need to recalc
                   });
                 });
               }

function readRiskInputsToState(){
  if(!window.state) return;
  if(!state.risk) state.risk = {};

const modeEl = document.getElementById("globalBufferMode");
  const valueEl = document.getElementById("globalBufferValue");
  const pctEl = document.getElementById("globalBufferPct"); // backward compatibility
  const mdEl = document.getElementById("globalBufferMd");   // backward compatibility
  const reasonEl = document.getElementById("bufferReason") || document.getElementById("globalBufferNotes");

  const mode = modeEl ? String(modeEl.value || "pct") : (state.risk.globalBufferMode || "pct");
  const rawValue = valueEl ? Number(valueEl.value) : null;
  const pct = pctEl ? Number(pctEl.value) : (mode === "pct" ? rawValue : Number(state.risk.globalBufferPct));
  const md = mdEl ? Number(mdEl.value) : (mode === "md" ? rawValue : Number(state.risk.globalBufferMd));

  state.risk.globalBufferMode = (mode === "md") ? "md" : "pct";
  state.risk.globalBufferPct = Number.isFinite(pct) && pct >= 0 ? pct : 0;
  state.risk.globalBufferMd = Number.isFinite(md) && md >= 0 ? md : 0;
  state.risk.bufferReason = reasonEl ? String(reasonEl.value || "") : "";
};

function updateTotalsFromItems(items){
  // Phase summary
  const ps = document.getElementById("phaseSummary");
  if(ps && Array.isArray(items)){
    const byPhase = {};
    items.forEach(it => {
      const ph = String(it.phase || "").replace(/^\+\s*/, "").trim();
      const md = Number(it.totalMd);
      if(!ph || !Number.isFinite(md)) return;
      byPhase[ph] = (byPhase[ph] || 0) + md;
    });
    const phases = Object.keys(byPhase);
    ps.innerHTML = phases.map(ph => (
      "<tr><td>" + escapeHtml(ph) + "</td><td class='right'>" + (byPhase[ph] || 0).toFixed(1) + "</td></tr>"
    )).join("");
  }

  // TOTAL DEV EFFORT row in detailed table
  const tbody = document.querySelector("#detailedTable tbody");
  if(tbody && Array.isArray(items)){
    const totalBase = items.reduce((s,it)=> s + (Number(it.totalMd ?? it.baseMd) || 0), 0);
    const __buf = computeGlobalBufferMd(totalBase);
    const total = (totalBase || 0) + (__buf.md || 0);
    const totalRow = Array.from(tbody.querySelectorAll("tr")).find(tr => (tr.textContent || "").includes("TOTAL DEV EFFORT"));
    if(totalRow){
      const tds = totalRow.querySelectorAll("td");
      const last = tds[tds.length - 1];
      if(last) last.innerHTML = "<strong>" + total.toFixed(1) + "</strong>";
    }
  }
}

function applyOverridesAndRefresh(){
                 if(!state.lastCalc || !Array.isArray(state.lastCalc.baseRows)) return;

                 readRiskInputsToState();

                 const tbody = document.querySelector("#detailedTable tbody");
                 if(!tbody) return;

                 const trList = Array.from(tbody.querySelectorAll("tr"));

                 const isSummaryRow = (tr) => {
                   const txt = (tr.textContent || "").toUpperCase();
                       return txt.includes("TOTAL DEV EFFORT") || txt.includes("GLOBAL BUFFER") || txt.includes("NOTES / ASSUMPTIONS") || txt.includes("TOTAL (INCL. BUFFER)");
                 };

                 // Ensure regular data rows have the new columns. If calculateEffort just ran, table currently has 6 cells.
                 trList.forEach((tr, idx) => {
				 if(isSummaryRow(tr)) return;
                   const rowId = tr.getAttribute("data-row-id") || ("row_" + idx);
                   tr.setAttribute("data-row-id", rowId);

                   const tds = Array.from(tr.querySelectorAll("td"));
                   if(tds.length === 6){
                     // Convert old layout to:
                     // Phase, Sub phase, Work Items, Qty, Rate, Base MD, Override, Override MD, Notes, Total in MD
                     const baseCell = tds[5];
                     const baseVal = parseFloat(baseCell.textContent) || 0;
                     baseCell.textContent = baseVal.toFixed(1);

                     // Override checkbox
                     const overrideTd = document.createElement("td");
                     const cb = document.createElement("input");
                     cb.type = "checkbox";
                     cb.className = "checkbox-sm";
                     cb.setAttribute("data-override-row", rowId);
                     cb.checked = !!state.overrides.enabledById[rowId];
                     overrideTd.appendChild(cb);

                     // Override MD input
                     const overrideMdTd = document.createElement("td");
                     const mdInp = document.createElement("input");
                     mdInp.className = "input-sm";
                     mdInp.type = "number";
                     mdInp.min = "0";
                     mdInp.step = "0.5";
                     mdInp.setAttribute("data-override-md-row", rowId);
                     const storedMd = state.overrides.mdById[rowId];
                     mdInp.value = Number.isFinite(storedMd) ? String(storedMd) : "";
                     mdInp.disabled = !cb.checked;
                     overrideMdTd.appendChild(mdInp);

                     // Notes
                     const notesTd = document.createElement("td");
                     const notesInp = document.createElement("input");
                     notesInp.className = "input-sm";
                     notesInp.type = "text";
                     notesInp.placeholder = "Notes and assumptions";
                     notesInp.setAttribute("data-notes-row", rowId);
                     notesInp.value = String(state.overrides.notesById[rowId] || tr.getAttribute("data-notes") || "");
                     notesTd.appendChild(notesInp);

                     // Total in MD (buffered total)
                     const totalTd = document.createElement("td");
                     totalTd.textContent = baseVal.toFixed(1);

                     tr.appendChild(overrideTd);
                     tr.appendChild(overrideMdTd);
                     tr.appendChild(notesTd);
                     tr.appendChild(totalTd);
                   }
                 });

                 wireOverrideInputs();
const gb = Number(state.risk?.globalBufferPct) || 0;

                

// Recompute totals directly from current DOM rows so overrides always match what user sees.
                 const items = Array.from(tbody.querySelectorAll("tr")).map((tr, idx) => {
                   if(isSummaryRow(tr)) return null;
                    const rowId = tr.getAttribute("data-row-id") || ("row_" + idx);
                   tr.setAttribute("data-row-id", rowId);

  // User-added rows
                   if(tr.getAttribute("data-user-added") === "1"){
                     const baseRaw = parseFloat(tr.querySelector('[data-user-base-md="1"]')?.value || "");
                     const baseMd = Number.isFinite(baseRaw) ? baseRaw : 0;

                     const overrideEnabled = !!tr.querySelector('[data-user-override="1"]')?.checked;
                     const overrideRaw = parseFloat(tr.querySelector('[data-user-override-md="1"]')?.value || "");
                     const overrideMd = Number.isFinite(overrideRaw) ? overrideRaw : null;

                     const effectiveBase = (overrideEnabled && overrideMd !== null) ? overrideMd : baseMd;
                     const bufferMd = effectiveBase * (gb / 100);
                     const totalMd = effectiveBase + bufferMd;

                     return {
                       id: rowId,
                       phase: String(tr.querySelector('[data-user-phase="1"]')?.value || "").trim(),
                       subPhase: String(tr.querySelector('[data-user-sub="1"]')?.value || "").trim(),
                       workItem: String(tr.querySelector('[data-user-work="1"]')?.value || "").trim(),
                       qty: String(tr.querySelector('[data-user-qty="1"]')?.value || "1").trim(),
                       rate: String(tr.querySelector('[data-user-rate="1"]')?.value || "").trim(),
                       isManual: true,

                       originalBaseMd: baseMd,
                       baseMd: effectiveBase,
                       overrideEnabled,
                       overrideMd: (overrideEnabled && overrideMd !== null) ? overrideMd : null,
                       notes: String(tr.querySelector('[data-user-notes="1"]')?.value || "").trim(),

                       bufferPct: gb,
                       bufferMd,
                       totalMd
                     };
                   }

                   const tds = Array.from(tr.querySelectorAll("td"));
                   const originalBase = parseFloat(tds[5]?.textContent || "") || 0;
                   const overrideEnabled = !!tr.querySelector('[data-override-row]')?.checked;
                   const overrideRaw = parseFloat(tr.querySelector('[data-override-md-row]')?.value || "");
                   const overrideMd = Number.isFinite(overrideRaw) ? overrideRaw : null;
                   const effectiveBase = (overrideEnabled && overrideMd !== null) ? overrideMd : originalBase;
                   const bufferMd = 0;
                   const totalMd = effectiveBase + bufferMd;

const notes = String(
                     tr.querySelector('[data-notes-row]')?.value ||
                     state.overrides.notesById[rowId] ||
                     tr.getAttribute("data-notes") || ""
                   );

                   // keep state in sync for export/import logic
                   state.overrides.enabledById[rowId] = overrideEnabled;
                   if(overrideMd === null){
                     delete state.overrides.mdById[rowId];
                   } else {
                     state.overrides.mdById[rowId] = overrideMd;
                   }
                   state.overrides.notesById[rowId] = notes;
                   return {
                     id: rowId,
                     phase: String(tds[0]?.textContent || "").trim(),
                     subPhase: String(tds[1]?.textContent || "").trim(),
                     workItem: String(tds[2]?.textContent || "").trim(),
                     qty: String(tds[3]?.textContent || "").trim(),
                     rate: String(tds[4]?.textContent || "").trim(),
                     isManual: tr.getAttribute("data-manual") === "1",

                     originalBaseMd: originalBase,
					 
					 
                     baseMd: effectiveBase,
                     overrideEnabled,
                     overrideMd: (overrideEnabled && overrideMd !== null) ? overrideMd : null,
notes,
                     bufferPct: gb,
                     bufferMd,
                     totalMd
                   };
                                  }).filter(Boolean);
                 const itemById = Object.fromEntries(items.map((it) => [String(it.id), it]));
const subtotalWithoutBuffer = items.reduce((s, it) => s + (Number(it.baseMd) || 0), 0);
                 const __buf = computeGlobalBufferMd(subtotalWithoutBuffer);
                 const bufferTotal = Number(__buf.md) || 0;
                 items.forEach((it) => {
                   const base = Number(it.baseMd) || 0;
                   const distributed = subtotalWithoutBuffer > 0 ? (bufferTotal * (base / subtotalWithoutBuffer)) : 0;
                   it.bufferPct = Number(__buf.pct) || 0;
                   it.bufferMd = distributed;
                   it.totalMd = base + distributed;
                 });

                 // Update table cells (Base MD stays original, Total is buffered total)
                 const rows = Array.from(tbody.querySelectorAll("tr"));
                 rows.forEach((tr, idx) => {
                   const rowId = tr.getAttribute("data-row-id") || ("row_" + idx);
                   const it = itemById[rowId];
                   if(!it) return;

                   const tds = Array.from(tr.querySelectorAll("td"));
                   // expected 10 cells now
                   if(tds.length >= 10){
                     // Base MD column - show original base
                     tds[5].textContent = (Number(it.originalBaseMd) || 0).toFixed(1);

                     // Override checkbox and inputs are already in place

                     // Notes
                     tr.setAttribute("data-notes", it.notes || "");

                     // Total in MD (last column)
                     tds[9].textContent = (Number(it.totalMd) || 0).toFixed(1);
                   }
				   // User-added rows keep totals in [data-user-total]
                   const userTotalTd = tr.querySelector('[data-user-total="1"]');
                   if(userTotalTd){
                     userTotalTd.textContent = (Number(it.totalMd) || 0).toFixed(1);
                   }
                 });

                 
                 const totalWithBuffer = subtotalWithoutBuffer + bufferTotal;

                 // Keep TOTAL DEV EFFORT row synced with recalculated subtotal (without buffer)
                 const totalDevRow = Array.from(tbody.querySelectorAll("tr")).find(tr => (tr.textContent || "").includes("TOTAL DEV EFFORT"));
                 if(totalDevRow){
                   const tds = Array.from(totalDevRow.querySelectorAll("td"));
                   const last = tds[tds.length - 1];
                   if(last) last.innerHTML = "<strong>" + subtotalWithoutBuffer.toFixed(1) + "</strong>";
                 }

                 // Update UI totals
                 if(el("totalEffort")){
                   el("totalEffort").textContent = "Total " + Math.round(totalWithBuffer) + " MD";
                   updateExecutiveSummaryTiles();
                 }
const pctCell = document.getElementById("bufferPctDisplay");
                 if(pctCell) pctCell.textContent = (Number(__buf.pct) || 0).toFixed(1) + "%";
                 const mdCell = document.getElementById("bufferMdDisplay");
                 if(mdCell) mdCell.textContent = (Number(bufferTotal) || 0).toFixed(1);
                 const totalInclCell = document.getElementById("totalInclBufferDisplay");
if(totalInclCell) totalInclCell.textContent = (Number(totalWithBuffer) || 0).toFixed(1);
                 
                 // Update phase summary (based on overridden totals)
                 const phaseSummary = el("phaseSummary");
                 if(phaseSummary){
                   const phaseTotals = {};
                   items.forEach(it => {
const ph = String(it.phase || "").replace(/^\+\s*/, "").trim() || "Other";
                     phaseTotals[ph] = (phaseTotals[ph] || 0) + (Number(it.totalMd) || 0);
                   });
                   const rowsHtml = Object.keys(phaseTotals).sort().map(ph =>
                     "<tr><td>" + escapeHtml(ph) + "</td><td>" + Math.round(phaseTotals[ph]) + " MD</td></tr>"
                   ).join("");
                   phaseSummary.innerHTML = rowsHtml;
                   updateExecutiveSummaryTiles();
                 }

// Update window.calculationData for CSV and external usage
                 window.calculationData = {
                   upgradeType: state.lastCalc.upgradeTypeLabel,
                   total: Math.round(totalWithBuffer),
                   totals: {
                     subtotalWithoutBuffer: subtotalWithoutBuffer,
                     bufferTotal: bufferTotal,
                     grandWithBuffer: totalWithBuffer
                   },
                   risk: {
                     globalBufferMode: state.risk.globalBufferMode,
                     globalBufferPct: state.risk.globalBufferPct,
                     globalBufferMd: state.risk.globalBufferMd,
                     bufferReason: state.risk.bufferReason
                   },
                   items: items,
                   // Backward compatibility
                   details: items.map((it) => ([
                     it.phase,
                     it.subPhase,
                     it.workItem,
                     it.qty,
                     it.rate,
                     (Number(it.originalBaseMd) || 0).toFixed(1),
                     String(it.overrideEnabled ? "Yes" : "No"),
                     (it.overrideMd === null ? "" : String(it.overrideMd)),
                     it.notes || "",
                     (Number(it.totalMd) || 0).toFixed(1)
                   ]))
                 };
               }

function readManualTasks(){
  // calculateEffort expects: [{ phase: string, effort: number }]
  const tasks = (window.state && Array.isArray(state.manualTasks)) ? state.manualTasks : [];
  return tasks.map(t => ({
    phase: t.phase || "",
    effort: (t.effort != null ? t.effort : t.md) || 0,
    notes: t.notes || ""
  }));
}

// Run calculation and scroll to results (only when user clicks Calculate)
function calculateAndScroll(){
  window.__scrollToResults = true;
  try{
    calculateEffort();
  } finally {
    // keep flag only for this call
    window.__scrollToResults = false;
  }
}

function computeGlobalBufferMd(totalDevMd){
  const total = Number(totalDevMd) || 0;
  const mode = (window.state && state.risk) ? String(state.risk.globalBufferMode || "pct") : "pct";
  const pct = (window.state && state.risk) ? (Number(state.risk.globalBufferPct) || 0) : 0;
  const mdValue = (window.state && state.risk) ? (Number(state.risk.globalBufferMd) || 0) : 0;

  if(mode === "md"){
    const md = Number.isFinite(mdValue) && mdValue > 0 ? mdValue : 0;
    const effectivePct = total > 0 ? ((md / total) * 100) : 0;
    return { mode: "md", pct: effectivePct, md: md };
  }

  if(!Number.isFinite(pct) || pct <= 0) return { mode: "pct", pct: 0, md: 0 };
  const md = total * (pct / 100.0);
  return { mode: "pct", pct: pct, md: md };
}


               function updateExecutiveSummaryTiles(){
                 const setText = (id, value) => {
                   const elx = document.getElementById(id);
                   if(elx) elx.textContent = value;
                 };

                 // Total from the existing totalEffort element (e.g., "Total 422 MD")
                 const total = document.getElementById("totalEffort")?.textContent?.trim() || "";
                 setText("tileTotal", total ? total.replace(/^Total\s*/i, "") : "-");

                 // Pull from phase summary table rows
                 const tbody = document.getElementById("phaseSummary");
                 const rows = tbody ? Array.from(tbody.querySelectorAll("tr")) : [];
                 const getMd = (phaseName) => {
                   const row = rows.find(r => (r.children?.[0]?.textContent || "").trim().toLowerCase() === phaseName.toLowerCase());
                   const v = row ? (row.children?.[1]?.textContent || "").trim() : "";
                   return v || "-";
                 };

                 setText("tileBuild", getMd("Build & System test"));
                 setText("tileCustomer", getMd("Customer testing"));

                 const totalText = document.getElementById("totalEffort")?.textContent || "";
                 const totalNum = Number((totalText.match(/([0-9]+(?:\.[0-9]+)?)/) || [])[1] || 0);
                 const baseTotal = state?.lastCalc?.baseRows ? state.lastCalc.baseRows.reduce((s, r) => s + (Number(r.baseMd) || 0), 0) : totalNum;
                 const buf = computeGlobalBufferMd(baseTotal);
                 setText("tileBufferMd", (Number(buf.md) || 0).toFixed(1));
               }

function calculateEffort() {
  readRiskInputsToState();
			   const perfRequired = el("performanceRequired")?.checked;
               const perfEffort = perfRequired ? (parseInt(el("performanceMd")?.value, 10) || 10) : 0;
                 const upgradeTypeEl = el("upgradeType");
                 const selectedUpgradeType = String((upgradeTypeEl && upgradeTypeEl.value) || "").trim();
                 const inferredUpgradeType = (state.coreVersionsCount >= 2)
                   ? "major"
                   : (state.coreVersionsCount === 1 ? "annual" : "quarterly");
                 const upgradeType = ["major", "annual", "quarterly"].includes(selectedUpgradeType)
                   ? selectedUpgradeType
                   : inferredUpgradeType;
                 if(upgradeTypeEl && upgradeTypeEl.value !== upgradeType) upgradeTypeEl.value = upgradeType;
               
                 const inputs = {
                   xmlFiles: parseInt(el("xmlFiles").value, 10) || 0,
                   jspFiles: parseInt(el("jspFiles").value, 10) || 0,
                   changedMethods: parseInt(el("changedMethods").value, 10) || 0,
                   changedQueries: parseInt(el("changedQueries").value, 10) || 0,
                   sessionBeans: parseInt(el("sessionBeans").value, 10) || 0,
                   coprs: parseInt(el("coprs").value, 10) || 0,
additionalProjectComplexity: parseInt(el("additionalProjectComplexity").value, 10) || 0,
channels: parseInt(el("channels").value, 10) || 0,

                   merges: parseInt(el("merges").value, 10) || 0,
                   minorUpgrades: parseInt(el("minorUpgrades").value, 10) || 0,
                   solutionDesign: parseInt(el("solutionDesign").value, 10) || 0,
                   newTechRate: parseFloat(el("newTechRate") ? el("newTechRate").value : 5) || 5,
                 };
               
                 // Rates
                 const rates = {
                   dbBase: { major: 15, annual: 10, quarterly: 5 },
                   stabilizing: { major: 15, annual: 15, quarterly: 10 },

                   xmlMergeRate: 0.4,
                   jspMergeRate: 0.4,
                   changedMethodRate: 0.2,
                   changedQueryRate: 0.5,
                   sessionBeanRate: 0.1,
                   coprRate: 0.2
                 };
               
                 // Core tasks (fixed per upgrade type)
                 let dbChanges = 0;
               
               if (upgradeType === "annual") {
               // Continuous annual upgrades: 10 MD for the first + 5 MD for each additional
               const count = state.coreVersionsCount || 1;
               dbChanges = 10 + Math.max(0, count - 1) * 5;
               } else if (upgradeType === "major") {
			   // Major (big-bang) upgrade: one-time effort
               dbChanges = 10;
               } else {
               // quarterly
               dbChanges = 5;
               }
               
                 const newTechEffort = (state.coreVersionsCount || 0) * (inputs.newTechRate || 5);

                 const stabilizing = Number(rates.stabilizing[upgradeType] ?? 0);
               
                 // File based
                 const xmlEffort = inputs.xmlFiles * rates.xmlMergeRate;
                 const jspEffort = inputs.jspFiles * rates.jspMergeRate;
                 const xmlJspCombinedEffort = xmlEffort + jspEffort;
               
                 const changedMethodsEffort = inputs.changedMethods * rates.changedMethodRate;
                 const changedQueriesEffort = inputs.changedQueries * rates.changedQueryRate;
               
                 const sessionEffort = inputs.sessionBeans * rates.sessionBeanRate;
                 const coprEffort = inputs.coprs * rates.coprRate;
               // Interfaces stabilization (dynamic rows)
               const interfaceRates = { simple: 1, medium: 3, complex: 5 };
               let interfacesEffort = 0;
               let interfacesQtyTotal = 0;
               let interfacesDesc = [];
               
               const requiredInterfaces = el("interfacesRequired") ? el("interfacesRequired").value : "no";
               if (requiredInterfaces === "yes") {
               const rows = document.querySelectorAll("#interfacesTable tr.interface-row");
               rows.forEach(row => {
               const typeEl = row.querySelector(".interface-type");
               const qtyEl = row.querySelector(".interface-qty");
               
               const type = typeEl ? typeEl.value : "simple";
               const qty = qtyEl ? (parseInt(qtyEl.value, 10) || 0) : 0;
               
               interfacesQtyTotal += qty;
               interfacesEffort += (interfaceRates[type] || 0) * qty;
               
               if (qty > 0) {
                 if (type === "simple") interfacesDesc.push("Simple x" + qty);
                 if (type === "medium") interfacesDesc.push("Medium x" + qty);
                 if (type === "complex") interfacesDesc.push("Complex x" + qty);
               }
               });
               }
               const interfacesDescText = interfacesDesc.length ? interfacesDesc.join(", ") : "None";
                  
               
                 // Optional blocks (not for quarterly)
                 const channelEffort = upgradeType !== "quarterly" ? inputs.channels * 3 : 0;
                 const mergeEffort = upgradeType !== "quarterly" ? inputs.merges * 5 : 0;
                 const minorEffort = upgradeType !== "quarterly" ? inputs.minorUpgrades * 5 : 0;
               
                 const sdEffort = inputs.solutionDesign;
               
                 const devEffort =
  dbChanges +
  newTechEffort +
  xmlJspCombinedEffort +
  changedMethodsEffort +
  changedQueriesEffort +
  sessionEffort +
  stabilizing +
  coprEffort +
  interfacesEffort +
inputs.additionalProjectComplexity +
  channelEffort +
  mergeEffort +
  minorEffort +
  sdEffort;


               
               
                 
                 const stDefects = devEffort * 0.4;

                 // Manual tasks
                 const manualTasks = readManualTasks();
                 const manualByPhase = { build: 0, customer: 0, perf: 0, devops: 0, other: 0 };
                 manualTasks.forEach((t) => {
                   const ph = normalizeManualPhase(t.phase);
                   const md = Number(t.effort) || 0;
                   if(ph === "Customer testing") manualByPhase.customer += md;
                   else if(ph === "Performance") manualByPhase.perf += md;
                   else if(ph === "DevOps") manualByPhase.devops += md;
                   else if(ph === "Other") manualByPhase.other += md;
                   else manualByPhase.build += md;
                 });

                 // Build effort that drives Customer Testing derivation (includes DevOps + Other by default)
                 const buildForDerivation = devEffort + stDefects + manualByPhase.build + manualByPhase.devops + manualByPhase.other;

                 // Customer Testing derived from Build
                 const customerTestingDerived = buildForDerivation * 0.5;

                 // Totals
                 const customerTestingTotal = customerTestingDerived + manualByPhase.customer;
                 const perfTotal = perfEffort + manualByPhase.perf;

                 const grandTotal = buildForDerivation + customerTestingTotal + perfTotal;
  const __buf = computeGlobalBufferMd(grandTotal);
  const totalDevWithBuffer = (Number(grandTotal) || 0) + (__buf.md || 0);


               
                 el("totalEffort").textContent = "Total " + Math.round(grandTotal) + " MD";
const detailedBody = document.querySelector("#detailedTable tbody");
               
               
               // Text blocks (Excel style)
               const scopeDb =
               (upgradeType === "annual")
               ? "for 1 upgrade - 10md, then for every additional upgrade it is additional 5md"
               : "fixed effort per upgrade type";
               
               const scopeFileChecker =
               "File checker results - merging project files with new core files in order to resolve compilation and runtime errors while trying to keep the existing project requirements and implementations and adjust them on top of core new implementation with minimal effort. " +
               "The target is to be able to start the developers servers with the new core version (get the login screen).";
               
               const scopeStabilizeMainFlows =
               "Conduct predefined list of basic sanity - while trying to keep basic project functionality and customizations:\n" +
               "Create & update contact per type\n" +
               "NB policy per product & MTA & Renewal & Cancellation\n" +
               "Create claim + payment & update\n" +
               "Manual billing.";
               
               const scopeCoprs =
               "Go over the list of coprs that were raised by the project in the past and resolved temporarely in the project and are now resolved by CORE and remove project layer fix and unit test with core fix - 0.2d per copr";
               
               const scopeInterfaces =
               "Simple - 1d (ie simple outgoing interface such as address, Google Maps, risk information)\n" +
               "Medium - 3d simple batches, multiple communication interfaces that trigger logic\n" +
               "Complex - 5d (BACS..)\n" +
               "Selected: " + interfacesDescText + " | Total items: " + interfacesQtyTotal + " | Total effort: " + interfacesEffort.toFixed(1) + "md";
               
               const scopeAdditionalComplexity =
               "Stabilization of specific project gaps that either involved major customizations from core or have significant impact on main project business flows.";
               
               const scopeAdditionalChannels =
               "stabilization of SUA / eTrade / portal flows - 3d per channel";
               
               const scopeMerges =
               "Merge code and setup from BAU branch to upgrade to branch - 5d per merge";
               
               const scopeMinorUpgrades =
               "Minor core upgrade (from 18.4.2 to 18.4.3) - 5d per upgrade";
               
               const scopeSolutionDesign =
               "implementing requirements that rise as a result of new core funcitonality that conflicts with project requirements";
               
               const scopeStDefects =
               "40% of development effort under the assumption that existing defects (that exist in the previuos phase prior to upgrade) will NOT be fixed during the upgrade";
               
               // Build rows (Excel style)
               detailedBody.innerHTML =
			   
			   // DevOps
  "<tr>" +
    "<td>Devops</td>" +
    "<td>Devops</td>" +
    "<td>Raise DevOps Tickets</td>" +
    "<td>1</td>" +
    "<td>1</td>" +
    "<td>1</td>" +
  "</tr>" +
  
  // Build & System test - Technical upgrade
  "<tr>" +
    "<td>Build & System test</td>" +
    "<td>Technical upgrade</td>" +
    "<td>Execution of DB changes</td>" +
    "<td>" + (upgradeType === "annual" ? state.coreVersionsCount : 1) + "</td>" +
    "<td>" + (upgradeType === "annual" ? "10 MD +5 per additional" : "fixed") + "</td>" +
    "<td>" + dbChanges.toFixed(1) + "</td>" +
  "</tr>" +

  "<tr>" +
    "<td>Build & System test</td>" +
    "<td>Technical upgrade</td>" +
    "<td>" +
      "<span class='label-with-help'>" +
        "Adoption of new core technologies" +
        "<span class='help-icon' tabindex='0' data-tooltip='Infra changes, Examples: KeyCloack, '>i</span>" +
      "</span>" +
    "</td>" +
    "<td>" + (state.coreVersionsCount || 0) + "</td>" +
    "<td>" + (inputs.newTechRate || 5) + "</td>" +
    "<td>" + newTechEffort.toFixed(1) + "</td>" +
  "</tr>" +

  "<tr>" +
      "<td>Build & System test</td>" +
    "<td>Technical upgrade</td>" +
    "<td>XML files</td>" +
    "<td>" + inputs.xmlFiles + "</td>" +
    "<td>0.4</td>" +
    "<td>" + xmlEffort.toFixed(1) + "</td>" +
  "</tr>" +

  "<tr>" +
      "<td>Build & System test</td>" +

    "<td>Technical upgrade</td>" +
    "<td>JSP files</td>" +
    "<td>" + inputs.jspFiles + "</td>" +
    "<td>0.4</td>" +
    "<td>" + jspEffort.toFixed(1) + "</td>" +
  "</tr>" +

  "<tr>" +
      "<td>Build & System test</td>" +

    "<td>Technical upgrade</td>" +
    "<td>Changed methods</td>" +
    "<td>" + inputs.changedMethods + "</td>" +
    "<td>0.2</td>" +
    "<td>" + changedMethodsEffort.toFixed(1) + "</td>" +
  "</tr>" +

  "<tr>" +
      "<td>Build & System test</td>" +

    "<td>Technical upgrade</td>" +
    "<td>Changed queries</td>" +
    "<td>" + inputs.changedQueries + "</td>" +
    "<td>0.5</td>" +
    "<td>" + changedQueriesEffort.toFixed(1) + "</td>" +
  "</tr>" +

  "<tr>" +
      "<td>Build & System test</td>" +

    "<td>Technical upgrade</td>" +
    "<td>SessionBean </td>" +
    "<td>" + inputs.sessionBeans + "</td>" +
    "<td>0.1</td>" +
    "<td>" + sessionEffort.toFixed(1) + "</td>" +
  "</tr>" +

 "<tr>" +
     "<td>Build & System test</td>" +

  "<td>Technical upgrade</td>" +
  "<td>" +
    "<span class='label-with-help'>" +
      "Stabilizing main flows - conduct basic main flows sanity" +
      "<span class='help-icon' tabindex='0' data-tooltip='" +
        "Conduct predefined list of basic sanity - while trying to keep basic project functionality and customizations:\n" +
        "Create & update contact per type\n" +
        "NB policy per product & MTA & Renewal & Cancellation\n" +
        "Create claim * payment & update\n" +
        "Manual billing." +
      "'>i</span>" +
    "</span>" +
  "</td>" +
  "<td>1</td>" +
  "<td>" + rates.stabilizing[upgradeType] + "</td>" +
  "<td>" + stabilizing.toFixed(1) + "</td>" +
"</tr>" +


"<tr>" +
    "<td>Build & System test</td>" +

  "<td> COPRs</td>" +
  "<td>" +
    "<span class='label-with-help'>" +
      "COPRs resolution" +
      "<span class='help-icon' tabindex='0' data-tooltip=' project layer Implementation due to COPRs resolved'>i</span>" +
    "</span>" +
  "</td>" +
  "<td>" + inputs.coprs + "</td>" +
  "<td>" + rates.coprRate + "</td>" +
  "<td>" + coprEffort.toFixed(1) + "</td>" +
"</tr>" +

"<tr>" +
  "<td>Build & System test</td>" +
  "<td>Integrations</td>" +
  "<td>" +
    "<span class='label-with-help'>" +
      "Project batches / interfaces stabilization" +
      "<span class='help-icon' tabindex='0' data-tooltip='" +
        "Simple - 1d (ie simple outgoing interface such as address, googleMap, risk information)\n" +
        "Medium - 3d simple batches, multiple communication interfaces that trigger logic\n" +
        "Complex - 5d (bacs..)" +
      "'>i</span>" +
    "</span>" +
  "</td>" +
  "<td>" + interfacesQtyTotal + "</td>" +
  "<td>Mixed (" + interfacesDescText + ")</td>" +
  "<td>" + interfacesEffort.toFixed(1) + "</td>" +
"</tr>" +



"<tr>" +
      "<td>Build & System test</td>" +                  			// Phase
      "<td>Additional Project complexity</td>" +                  // Sub phase
      "<td>Project-specific gaps and heavy customizations</td>" + // Work Items
      "<td>" + inputs.additionalProjectComplexity + "</td>" +     // Qty
      "<td>1</td>" +                                              // Rate
      "<td>" + inputs.additionalProjectComplexity.toFixed(1) + "</td>" + // Total
    "</tr>" +

"<tr>" +
  "<td>Build & System test</td>" +
  "<td>Project additions</td>" +
  "<td>" +
    "<span class='label-with-help'>" +
      "Additional channels" +
      "<span class='help-icon' tabindex='0' data-tooltip='Channels stabilization. 3 MD per channel (SUA / eTrade / Portal).'>i</span>" +
    "</span>" +
  "</td>" +
  "<td>" + inputs.channels + "</td>" +
  "<td>3</td>" +
  "<td>" + channelEffort.toFixed(1) + "</td>" +
"</tr>" +


  "<tr>" +
    "<td>Build & System test</td>" +
    "<td>Merges from BAU branch</td>" +
	"<td>" +
	"<span class='label-with-help'>" +
    "Merge code and setup from BAU branch to upgrade to branch" +
	 "<span class='help-icon' tabindex='0' data-tooltip='5d per merge'>i</span>" +
    "</span>" +
    "<td>" + inputs.merges + "</td>" +
    "<td>5</td>" +
    "<td>" + mergeEffort.toFixed(1) + "</td>" +
  "</tr>" +

  "<tr>" +
        "<td>Build & System test</td>" +

    "<td>Minor core upgrades</td>" +
    "<td>ex. Minor core upgrade (from 18.4.2 to 18.4.3 ) </td>" +
    "<td>" + inputs.minorUpgrades + "</td>" +
    "<td>5</td>" +
    "<td>" + minorEffort.toFixed(1) + "</td>" +
  "</tr>" +

  "<tr>" +
        "<td>Build & System test</td>" +

    "<td>Solution Design Output</td>" +
    "<td>implementing requirements that rise as a result of new core funcitonality that conflicts  with project requirements</td>" +
    "<td>" + inputs.solutionDesign + "</td>" +
    "<td>1</td>" +
    "<td>" + sdEffort.toFixed(1) + "</td>" +
  "</tr>" +

  "<tr>" +
     "<td>Build & System test</td>" +
    "<td>ST defect fixing</td>" +
    "<td>40% of development effort under the assumption that existing defects (that exist in the previuos phase prior to upgrade ) will NOT be fixed during the upgrade</td>" +
    "<td>-</td>" +
    "<td>40%</td>" +
    "<td>" + stDefects.toFixed(1) + "</td>" +
  "</tr>" +

  "<tr>" +
    "<td>Customer testing</td>" +
    "<td>SIT/UAT support</td>" +
    "<td>at least 50% of the dev team , but depends on customer testing plan </td>" +
	"<td>-</td>" +
    "<td>50%</td>" +
    "<td>" + customerTestingDerived.toFixed(1) + "</td>" +
  "</tr>" +



  
  "<tr>" +
    "<td>Performance</td>" +
    "<td>Validation and tuning</td>" +
    "<td>Performance validation and tuning</td>" +
    "<td>" + (perfRequired ? 1 : 0) + "</td>" +
    "<td>" + (perfRequired ? (parseInt(el("performanceMd")?.value, 10) || 10) : 0) + "</td>" +
    "<td>" + perfEffort.toFixed(1) + "</td>" +
  "</tr>" +

"<tr>" +
    "<td colspan='5'><strong>TOTAL DEV EFFORT</strong></td>" +
    "<td><strong>" + grandTotal.toFixed(1) + "</strong></td>" +
  "</tr>" +
  "<tr>" +
    "<td colspan='5'>Global Buffer / Sick Leaves</td>" +
    "<td>" +
      "<div style='display:flex; gap:6px; align-items:center; justify-content:flex-end; flex-wrap:nowrap;'>" +
	   "<input id='globalBufferValue' class='input-sm' type='number' min='0' step='0.1' style='width:110px; text-align:right;' value='" + (((state.risk.globalBufferMode || 'pct') === 'md' ? (Number(state.risk.globalBufferMd)||0) : (Number(state.risk.globalBufferPct)||0))) + "' />" +
	  "<select id='globalBufferMode' class='input-sm' style='width:88px;'>" +
          "<option value='pct'" + ((state.risk.globalBufferMode || 'pct') === 'pct' ? " selected" : "") + ">% </option>" +
          "<option value='md'" + ((state.risk.globalBufferMode || 'pct') === 'md' ? " selected" : "") + ">MD</option>" +
        "</select>" +
      "</div>" +
    "</td>" +
  "</tr>" +
"<tr><td colspan='5'>Global Buffer Summary</td><td><div style='display:flex; align-items:center; justify-content:flex-end; gap:12px; flex-wrap:wrap;'><span>" +
    "<strong id='bufferPctDisplay'>" + ((__buf.pct && Number.isFinite(__buf.pct)) ? (__buf.pct.toFixed(1) + '%') : '0%') + "</strong>" +
    "</span><span>" +
    "<strong id='bufferMdDisplay'>" + (__buf.md ? __buf.md.toFixed(1) : '0.0') + "</strong> MD" +
    "</span></div></td></tr>" +  
	  "<tr><td colspan='2'>Notes / Assumptions</td><td colspan='4'><textarea id='globalBufferNotes' class='input-sm' placeholder='Optional notes' style='width:100%; min-height:72px; resize:vertical;'>" + escapeHtml(String(state.risk.bufferReason || '')) + "</textarea></td></tr>" +
	  "<tr><td colspan='5'><strong>Total (incl. buffer)</strong></td><td><strong id='totalInclBufferDisplay'>" + totalDevWithBuffer.toFixed(1) + "</strong></td></tr>";

               // Append manual tasks into the detailed breakdown (so they are part of the plan)
               if(Array.isArray(state.manualTasks) && state.manualTasks.length){
                 const safe = (s) => escapeHtml(String(s || ""));
                 const tasksSorted = state.manualTasks.slice().sort((a,b) => {
                   const pa = String(a.phase||"");
                   const pb = String(b.phase||"");
                   if(pa !== pb) return pa.localeCompare(pb);
                   const oa = parseInt(a.order,10); const ob = parseInt(b.order,10);
                   return (Number.isFinite(oa)?oa:50) - (Number.isFinite(ob)?ob:50);
                 });
                 const rowsHtml = tasksSorted.map((t, i) => {
                   const phase = safe(t.phase || "Manual Tasks");
                   const sub = safe(t.subPhase || "General");
                   const name = safe(t.name || ("Manual Task " + (i+1)));
                   const md = Number(t.md != null ? t.md : t.effort) || 0;
                   const notes = safe(t.notes || "");
                   return (
                     "<tr data-manual=\"1\" data-notes=\"" + notes + "\">" +
                       "<td>" + phase + "</td>" +
                       "<td>" + sub + "</td>" +
                       "<td>" + name + "</td>" +
                       "<td>1</td>" +
                       "<td>Manual</td>" +
                       "<td>" + md.toFixed(1) + "</td>" +
                     "</tr>"
                   );
                 }).join("");
                 detailedBody.insertAdjacentHTML("beforeend", rowsHtml);
               }

               
               

               // Add manual tasks as regular rows in the detailed table
               (function(){
                 if(!detailedBody) return;

                 const customerDerivedRow = Array.from(detailedBody.querySelectorAll("tr")).find((tr) => {
                   const tds = tr.querySelectorAll("td");
                                      const phase = (tds[0]?.textContent || "").replace(/^\+\s*/, "").trim();
                   const workItem = (tds[2]?.textContent || "").trim();
                   return phase === "Customer testing" && workItem.toLowerCase().includes("customer testing - derived");
                 });

                 const performanceBaseRow = Array.from(detailedBody.querySelectorAll("tr")).find((tr) => {
                   const tds = tr.querySelectorAll("td");
                   const phase = (tds[0]?.textContent || "").replace(/^\+\s*/, "").trim();
                   return phase === "Performance";
                 });

                 function makeRow(t, rowId){
                   const phase = String(t.phase || "").trim();
                   const subPhase = String(t.subPhase || "").trim();
                   const name = String(t.taskName || "").trim();
                   const effort = Number(t.effort) || 0;
                   const notes = String(t.notes || "");

                   const tr = document.createElement("tr");
                   tr.setAttribute("data-row-id", rowId);
                   tr.setAttribute("data-manual", "1");
                   tr.setAttribute("data-notes", notes);

                   tr.innerHTML =
                     "<td>" + escapeHtml(phase) + "</td>" +
                     "<td>" + escapeHtml(subPhase) + "</td>" +
                     "<td>" + escapeHtml(name) + "</td>" +
                     "<td>1</td>" +
                     "<td>-</td>" +
                     "<td>" + effort.toFixed(1) + "</td>";
                   return tr;
                 }

                 manualTasks.forEach((t, i) => {
                   const rowId = "manual_" + i;
                   const ph = normalizeManualPhase(t.phase);

                   // Keep selected phase label, but apply default rule for DevOps/Other in calculations above
                   const effectivePhase = String(t.phase || "").trim() || ph;
                   const row = makeRow({ ...t, phase: effectivePhase }, rowId);

                   if(ph === "Customer testing" && customerDerivedRow){
                     customerDerivedRow.insertAdjacentElement("afterend", row);
                   } else if(ph === "Performance" && performanceBaseRow){
                     performanceBaseRow.insertAdjacentElement("afterend", row);
                   } else if(customerDerivedRow){
                     detailedBody.insertBefore(row, customerDerivedRow);
                   } else {
                     detailedBody.appendChild(row);
                   }
                 });
               })();

el("resultsSection").style.display = "block";
               if(window.__scrollToResults){ el("resultsSection").scrollIntoView({ behavior: "smooth" }); }
               
               // Save base calculation rows for buffer application and CSV generation
               const baseRows = Array.from(detailedBody.querySelectorAll("tr")).map((row, idx) => {
			    const txt = (row.textContent || "").toUpperCase();
                 if(
                   txt.includes("TOTAL DEV EFFORT") ||
                   txt.includes("GLOBAL BUFFER") ||
                   txt.includes("NOTES / ASSUMPTIONS") ||
                   txt.includes("TOTAL (INCL. BUFFER)")
                 ){
                   return null;
                 }
                 const cells = Array.from(row.querySelectorAll("td")).map((c) => c.textContent.trim());
                 // Expected columns before buffer is applied: Phase, Sub phase, Work Items, Qty, Rate, Total in MD
                 return {
                    id: row.getAttribute("data-row-id") || ("row_" + idx),
                    phase: cells[0] || "",
                    subPhase: cells[1] || "",
                    workItem: cells[2] || "",
                    qty: cells[3] || "",
                    rate: cells[4] || "",
                    baseMd: parseFloat(cells[5]) || 0,
                    isManual: row.getAttribute("data-manual") === "1",
                    notes: row.getAttribute("data-notes") || ""
                  };
               }).filter(Boolean);

               updateTotalsFromItems(baseRows);

                 state.lastCalc = {
                 upgradeTypeLabel: typeNames[upgradeType],
                 baseRows
               };

               // Apply buffer and refresh results (executive summary, phase summary, detailed, CSV data)
			   wireBufferInputs();
               applyOverridesAndRefresh();

}
// --- End restored core calculation + overrides ---



// --- TXT upload auto-calc wiring (restored) ---
(function(){
                 const __txt = document.getElementById("txtUpload");
                 if(!__txt) return;
                 __txt.addEventListener("change", function (e) {
                 const file = e.target.files[0];
                 if (!file) return;
               
                 const reader = new FileReader();
                 reader.onload = function (evt) {
                   const content = String(evt.target.result || "");
                   const lower = content.toLowerCase();
                   const lines = lower.split(/\r?\n/);
               
                   const xmlCount = (lower.match(/\.xml\b/gi) || []).length;
                   const jspCount = (lower.match(/\.jsp\b/gi) || []).length;
                   const sessionCount = (lower.match(/sessionbean/gi) || []).length;
               
                   const changedMethodsRegex = /changed methods\s*-\s*(\d+)\s*:/i;
                   const changedQueriesRegex = /changed queries\s*-\s*(\d+)\s*:/i;
               
                   let changedMethodsTotal = 0;
                   let changedQueriesTotal = 0;
               
                   for (const line of lines) {
                     const m1 = line.match(changedMethodsRegex);
                     if (m1) changedMethodsTotal += parseInt(m1[1], 10);
               
                     const m2 = line.match(changedQueriesRegex);
                     if (m2) changedQueriesTotal += parseInt(m2[1], 10);
                   }
               
                   window.autoCounts = {
                     xmlFiles: xmlCount || 0,
                     jspFiles: jspCount || 0,
                     changedMethods: changedMethodsTotal || 0,
                     changedQueries: changedQueriesTotal || 0,
                     sessionBeans: sessionCount || 0
                   };

                   // Build details lists for the "Auto-calculated from file" section
                   const originalLines = String(evt.target.result || "").split(/\r?\n/);
                   const lowerLines = originalLines.map(l => String(l).toLowerCase());

                   const xmlLines = [];
                   const jspLines = [];
                   const sessionLines = [];

                   for (let i = 0; i < originalLines.length; i++) {
                     const raw = String(originalLines[i] || "").trim();
                     const low = String(lowerLines[i] || "");
                     if (!raw) continue;
                     if (low.includes(".xml")) xmlLines.push(raw);
                     if (low.includes(".jsp")) jspLines.push(raw);
                     if (low.includes("sessionbean")) sessionLines.push(raw);
                   }

                   function collectSectionItems(sectionHeaderRegex) {
                     const items = [];
                     let inSection = false;

                     for (let i = 0; i < originalLines.length; i++) {
                       const raw = String(originalLines[i] || "");
                       const low = String(lowerLines[i] || "");

                       const isHeader = sectionHeaderRegex.test(low);
                       const isOtherHeader =
                         /changed methods\s*-\s*\d+\s*:/i.test(low) ||
                         /changed queries\s*-\s*\d+\s*:/i.test(low);

                       if (isHeader) {
                         inSection = true;
                         continue;
                       }

                       if (inSection && isOtherHeader) {
                         // reached next section
                         break;
                       }

                       if (inSection) {
                         const t = raw.trim();
                         if (!t) continue;
                         // stop on common separators
                         if (/^[-=]{3,}$/.test(t)) continue;
                         items.push(t);
                       }
                     }

                     return items;
                   }

                   const changedMethodsItems = collectSectionItems(/changed methods\s*-\s*\d+\s*:/i);
                   const changedQueriesItems = collectSectionItems(/changed queries\s*-\s*\d+\s*:/i);

                   window.autoDetails = {
                     xmlFiles: xmlLines,
                     jspFiles: jspLines,
                     changedMethods: changedMethodsItems,
                     changedQueries: changedQueriesItems,
                     sessionBeans: sessionLines
                   };

                   // Update UI lists if user is already on step 2
                   setTimeout(function(){
                     if(typeof applyAutoCountsToInputs==="function"){ applyAutoCountsToInputs(); }
                     if(typeof wireAutoDetailsToggles==="function"){ wireAutoDetailsToggles(); }
                   }, 0);
};
                 reader.readAsText(file);
               });
               
               
               })();

// --- End TXT upload auto-calc wiring ---

// --- Patch: Core version From/To dependency ---
function coreMajorFromKey(key){
  // supports "core18_0" or "core 18.0" etc
  const s = String(key || "");
  const m = s.match(/core\s*([0-9]+)/i) || s.match(/core([0-9]+)/i);
  return m ? parseInt(m[1], 10) : NaN;
}
function coreMinorFromKey(key){
  const s = String(key || "");
  const m = s.match(/_([0-9]+)$/) || s.match(/\.\s*([0-9]+)\s*$/);
  return m ? parseInt(m[1], 10) : NaN;
}
function coreKeyToNumber(key){
  const maj = coreMajorFromKey(key);
  const min = coreMinorFromKey(key);
  if(!Number.isFinite(maj)) return NaN;
  return maj * 1000 + (Number.isFinite(min) ? min : 0);
}

function rebuildCoreSelectors(){
  const fromSel = document.getElementById("coreFrom");
  const toSel = document.getElementById("coreTo");
  if(!fromSel || !toSel) return;
  if(!Array.isArray(window.CORE_VERSIONS)) return;

  const prevFrom = fromSel.value;
  const prevTo = toSel.value;

  // Rebuild FROM - always show all versions (do not hide older ones)
  fromSel.innerHTML = "";
  window.CORE_VERSIONS.forEach(o => {
    const opt = document.createElement("option");
    opt.value = o.key;
    opt.textContent = o.label;
    fromSel.appendChild(opt);
  });

  // Restore previous selection if still exists
  if(prevFrom && window.CORE_VERSIONS.some(x => x.key === prevFrom)){
    fromSel.value = prevFrom;
  } else if(window.CORE_VERSIONS.length){
    fromSel.value = window.CORE_VERSIONS[0].key;
  }

  // Rebuild TO based on FROM
  rebuildCoreToOptions();

  // Restore previous TO if valid
  if(prevTo){
    const exists = Array.from(toSel.options).some(o => o.value === prevTo);
    if(exists) toSel.value = prevTo;
  }
}

function rebuildCoreToOptions(){
  const fromSel = document.getElementById("coreFrom");
  const toSel = document.getElementById("coreTo");
  if(!fromSel || !toSel) return;
  if(!Array.isArray(window.CORE_VERSIONS)) return;

  const fromVal = fromSel.value;
  const fromNum = coreKeyToNumber(fromVal);

  toSel.innerHTML = "";
  
  const placeholder = document.createElement("option");
  placeholder.value = "";
  placeholder.textContent = "Select...";
  toSel.appendChild(placeholder);

  // allow TO >= FROM by default (can be changed to > if needed)
  const allowed = window.CORE_VERSIONS.filter(o => {
    const n = coreKeyToNumber(o.key);
    if(!Number.isFinite(fromNum) || !Number.isFinite(n)) return true;
    return n >= fromNum;
  });

  allowed.forEach(o => {
    const opt = document.createElement("option");
    opt.value = o.key;
    opt.textContent = o.label;
    toSel.appendChild(opt);
  });

  // keep TO empty to enforce explicit selection
  toSel.value = "";

  // trigger downstream updates if exist
  if(typeof updateTechDashboard === "function") updateTechDashboard();
  if(typeof updateVersionsCount === "function") updateVersionsCount();
}

function wireCoreVersionDependency(){
  const fromSel = document.getElementById("coreFrom");
  const toSel = document.getElementById("coreTo");
  if(!fromSel || !toSel) return;

  // If options already exist, just ensure dependency; otherwise rebuild.
  if(fromSel.options.length === 0 || toSel.options.length === 0){
    rebuildCoreSelectors();
  } else {
    rebuildCoreToOptions();
  }

  fromSel.addEventListener("change", function(){
    rebuildCoreToOptions();
  });
}

(function wireCoreFromToHandlers(){
  const fromSel = document.getElementById("coreFrom");
  const toSel = document.getElementById("coreTo");
  if(!fromSel || !toSel) return;

  // Initial
  updateToOptionsFromFromSelection();
  updateUpgradeScopeFromRange();

  fromSel.addEventListener("change", function(){
    const prevTo = toSel.value;
    updateToOptionsFromFromSelection();
    const stillValid = Array.from(toSel.options).some(o => o.value === prevTo);
    if(stillValid) toSel.value = prevTo;
    updateUpgradeScopeFromRange();
  });

  toSel.addEventListener("change", function(){
    updateUpgradeScopeFromRange();
  });
})();



function wireBufferInputs(){
  const modeEl = document.getElementById("globalBufferMode");
  const valueEl = document.getElementById("globalBufferValue");
  const reasonEl = document.getElementById("globalBufferNotes") || document.getElementById("bufferReason");
  if(!modeEl && !valueEl && !reasonEl) return;

  function syncPlaceholder(){
    if(!valueEl || !modeEl) return;
    valueEl.placeholder = modeEl.value === "md" ? "e.g. 18" : "e.g. 10";
  }

  function onChange(){
  syncPlaceholder();
    readRiskInputsToState();
    if(typeof applyOverridesAndRefresh === "function"){
      applyOverridesAndRefresh(); // updates totals and buffer rows
    }
  }
  if(modeEl && !modeEl.__bufWired){ modeEl.__bufWired = true; modeEl.addEventListener("change", onChange); }
  if(valueEl && !valueEl.__bufWired){ valueEl.__bufWired = true; valueEl.addEventListener("input", onChange); }
  if(reasonEl && !reasonEl.__bufWired){ reasonEl.__bufWired = true; reasonEl.addEventListener("input", onChange); }
  syncPlaceholder();
}


function wireAutoDetailsToggles() {
const toggles = document.querySelectorAll(".auto-details-toggle");
  if(!toggles.length) return;

  toggles.forEach((toggleBtn) => {
    const metric = toggleBtn.dataset.metric;
    const row = document.getElementById(`${metric}DetailsRow`);
    const countEl = document.getElementById(`${metric}DetailsCount`);
    const listEl = document.getElementById(`${metric}DetailsList`);
    if(!metric || !row || !countEl || !listEl) return;

    const detailItems = Array.isArray(window.autoDetails && window.autoDetails[metric])
      ? window.autoDetails[metric]
      : [];

    countEl.textContent = `${detailItems.length} item${detailItems.length === 1 ? "" : "s"}`;

    if(detailItems.length){
      listEl.innerHTML = detailItems
        .map((item) => `<div class="details-item">${escapeHtml(String(item))}</div>`)
        .join("");
    } else {
      listEl.innerHTML = '<span class="details-empty">No details loaded.</span>';
    }

    if(toggleBtn.dataset.wired !== "1"){
      toggleBtn.dataset.wired = "1";
      toggleBtn.addEventListener("click", () => {
        const currentlyOpen = row.style.display !== "none";
        row.style.display = currentlyOpen ? "none" : "table-row";
        toggleBtn.textContent = currentlyOpen ? "Details" : "Hide";
      });
    }
  });
}

document.addEventListener("DOMContentLoaded", function(){
                 const __calc2 = document.getElementById('calculateEffortBtnStep2');
                 if(__calc2){ __calc2.addEventListener('click', function(){ if(typeof calculateEffort==='function'){ calculateEffort(); } }); }

                 wireJiraHelpModal();
                 wireJiraParentModal();
                  wireTechDashboard();
                  wireCoreVersionDependency();
                  wireManualTasks();
                  wireAutoDetailsToggles();
                  wireStep1Navigation();
				  wireJsonImportExport();
				                    wireBufferInputs();
               });


  function updateCsvButtonEnabled(){
    const btn = document.getElementById('downloadJiraCsvBtn') || document.querySelector('[data-action="download-csv-jira"]');
    if(!btn) return;
    const ok = !!(window.calculationData && Array.isArray(window.calculationData.items) && window.calculationData.items.length);
    btn.disabled = !ok;
    btn.title = ok ? '' : 'Please recalculate before exporting CSV';
  }

  // Wrap calculateEffort to refresh button state
  const __origCalcEffort2 = window.calculateEffort;
  if(typeof __origCalcEffort2 === 'function'){
    window.calculateEffort = function(){
      const r = __origCalcEffort2.apply(this, arguments);
      try { updateCsvButtonEnabled(); } catch(e) {}
      return r;
    };
  }
  
  /* --- Gantt generation wiring --- */
(function(){
  function q(sel, root){ return (root || document).querySelector(sel); }
  function qa(sel, root){ return Array.from((root || document).querySelectorAll(sel)); }

  function parseDate(value){
    if(!value) return null;
    const d = new Date(value + "T00:00:00");
    return Number.isFinite(d.getTime()) ? d : null;
  }


 const DAY_MS = 24 * 60 * 60 * 1000;
  const COUNTRY_WEEKENDS = {
    IN: new Set([0, 6]),
    PL: new Set([0, 6]),
    DE: new Set([0, 6]),
    IL: new Set([5, 6])
  };

  const holidayCache = new Map();

  function readSelectedCountries(){
    const sel = q('#ganttCountries');
    if(!sel) return [];
    return Array.from(sel.selectedOptions || []).map((o) => o.value).filter(Boolean);
  }

  async function fetchCountryYearHolidays(countryCode, year){
    const cacheKey = `${countryCode}-${year}`;
    if(holidayCache.has(cacheKey)) return holidayCache.get(cacheKey);

    const promise = fetch(`https://date.nager.at/api/v3/PublicHolidays/${year}/${countryCode}`)
      .then((res) => {
        if(!res.ok) throw new Error(`Holiday API ${res.status}`);
        return res.json();
      })
      .then((rows) => new Set((Array.isArray(rows) ? rows : []).map((r) => String(r.date || '').slice(0, 10)).filter(Boolean)))
      .catch(() => new Set());

    holidayCache.set(cacheKey, promise);
    return promise;
  }

  async function buildHolidaySet(countryCodes, years){
    const all = await Promise.all(countryCodes.flatMap((code) => years.map((year) => fetchCountryYearHolidays(code, year))));
    const merged = new Set();
    all.forEach((setObj) => setObj.forEach((d) => merged.add(d)));
    return merged;
  }

  function buildWeekendSet(countryCodes){
    if(!countryCodes.length) return new Set([0, 6]);
    const merged = new Set();
    countryCodes.forEach((code) => {
      const days = COUNTRY_WEEKENDS[code] || new Set([0, 6]);
      days.forEach((d) => merged.add(d));
    });
    return merged;
  }

  function isoDate(d){ return d.toISOString().slice(0, 10); }

  function isNonWorkingDay(d, weekendSet, holidaySet){
    return weekendSet.has(d.getDay()) || holidaySet.has(isoDate(d));
  }

  function nextWorkingDay(date, weekendSet, holidaySet){
    const d = new Date(date.getTime());
    while(isNonWorkingDay(d, weekendSet, holidaySet)) d.setDate(d.getDate() + 1);
    return d;
  }

  function addWorkingDays(startDate, workingDays, weekendSet, holidaySet){
    const d = nextWorkingDay(startDate, weekendSet, holidaySet);
    let remaining = Math.max(1, workingDays);
    while(remaining > 0){
      if(!isNonWorkingDay(d, weekendSet, holidaySet)) remaining -= 1;
      if(remaining > 0) d.setDate(d.getDate() + 1);
    }
    d.setDate(d.getDate() + 1);
    return d;
  }
  function readRowLabel(tr, groupBy){
    const tds = qa('td', tr);
    if(groupBy === 'subphase' || groupBy === 'subPhase') return (tds[1] && tds[1].textContent || '').trim();
    if(groupBy === 'workitem') return (tds[2] && tds[2].textContent || '').trim();
    return (tds[0] && tds[0].textContent || '').replace(/[+x]/g, '').trim();
  }

  function readRowMd(tr){
    const userTotal = tr.querySelector('[data-user-total="1"]');
    if(userTotal){
      const v = parseFloat(userTotal.textContent || '');
      return Number.isFinite(v) ? v : 0;
    }
    const tds = qa('td', tr);
    const v = parseFloat((tds[9] && tds[9].textContent || '').trim());
    return Number.isFinite(v) ? v : 0;
  }

  function collectGanttTasks(groupBy){
    const tbody = q('#detailedTable tbody');
    if(!tbody) return [];
    const grouped = new Map();

    qa('tr', tbody).forEach((tr) => {
      const txt = (tr.textContent || '').toUpperCase();
      if(txt.includes('TOTAL DEV EFFORT') || txt.includes('GLOBAL BUFFER') || txt.includes('TOTAL (INCL. BUFFER)')) return;
      const label = readRowLabel(tr, groupBy);
      const md = readRowMd(tr);
      if(!label || md <= 0) return;
      grouped.set(label, (grouped.get(label) || 0) + md);
    });

    return Array.from(grouped.entries()).map(([label, md]) => ({ label, md }));
  }

  async  function renderGantt(){
    const wrap = q('#ganttSvgWrap');
    const startDate = parseDate(q('#ganttStartDate') && q('#ganttStartDate').value);
    const mdPerWeek = parseFloat(q('#ganttMdPerWeek') && q('#ganttMdPerWeek').value || '');
    const groupBy = (q('#ganttGroupBy') && q('#ganttGroupBy').value) || 'phase';
 const countryCodes = readSelectedCountries();
 
    if(!wrap) return;
    if(!startDate || !(mdPerWeek > 0)){
      wrap.innerHTML = '<div style="color:#b42318;">Provide a valid start date and capacity (MD per week).</div>';
      return;
    }

    const tasks = collectGanttTasks(groupBy);
    if(!tasks.length){
      wrap.innerHTML = '<div style="color:#344054;">No tasks with effort found. Run calculation first.</div>';
      return;
    }

  const workingDaysPerWeek = 5;
    const mdPerWorkingDay = mdPerWeek / workingDaysPerWeek;
    const weekendSet = buildWeekendSet(countryCodes);

    let totalExpectedCalendarDays = 0;
    tasks.forEach((t) => {
      const workingDays = Math.max(1, Math.ceil(t.md / mdPerWorkingDay));
      totalExpectedCalendarDays += workingDays + 10;
    });
    const finalYear = new Date(startDate.getTime() + totalExpectedCalendarDays * DAY_MS).getFullYear();
    const years = [];
    for(let y = startDate.getFullYear(); y <= finalYear; y += 1) years.push(y);
    const holidaySet = await buildHolidaySet(countryCodes, years);
	
    const dayWidth = 10;
    const rowH = 30;
    const leftPad = 220;
    const topPad = 30;

    let cursor = nextWorkingDay(startDate, weekendSet, holidaySet);
    const bars = tasks.map((t) => {
       const workingDays = Math.max(1, Math.ceil(t.md / mdPerWorkingDay));
      const barStart = nextWorkingDay(cursor, weekendSet, holidaySet);
      const barEndExclusive = addWorkingDays(barStart, workingDays, weekendSet, holidaySet);
      cursor = barEndExclusive;
      return {
        ...t,
        barStart,
        barEndExclusive,
        workingDays,
        start: Math.round((barStart.getTime() - startDate.getTime()) / DAY_MS),
        days: Math.max(1, Math.round((barEndExclusive.getTime() - barStart.getTime()) / DAY_MS))
      };
    });

    const totalDays = Math.max(14, Math.round((cursor.getTime() - startDate.getTime()) / DAY_MS));
    const width = leftPad + totalDays * dayWidth + 40;
    const height = topPad + bars.length * rowH + 30;

    const esc = (s) => String(s)
      .replace(/&/g, '&amp;')
      .replace(/</g, '&lt;')
      .replace(/>/g, '&gt;')
      .replace(/"/g, '&quot;');

    let svg = `<svg id="ganttSvg" xmlns="http://www.w3.org/2000/svg" width="${width}" height="${height}" viewBox="0 0 ${width} ${height}">`;
    svg += `<rect x="0" y="0" width="${width}" height="${height}" fill="#fff"/>`;

    for(let d = 0; d <= totalDays; d += 7){
      const x = leftPad + d * dayWidth;
      svg += `<line x1="${x}" y1="${topPad - 10}" x2="${x}" y2="${height - 10}" stroke="#e4e7ec"/>`;
      const date = new Date(startDate.getTime() + d * 86400000);
      svg += `<text x="${x + 2}" y="15" font-size="10" fill="#667085">${date.toISOString().slice(0,10)}</text>`;
    }

    bars.forEach((b, i) => {
      const y = topPad + i * rowH;
      const x = leftPad + b.start * dayWidth;
      const w = Math.max(8, b.days * dayWidth);
      svg += `<text x="10" y="${y + 17}" font-size="12" fill="#101828">${esc(b.label)}</text>`;
      svg += `<rect x="${x}" y="${y}" width="${w}" height="18" rx="4" fill="#2e90fa"/>`;
      svg += `<text x="${x + 6}" y="${y + 13}" font-size="11" fill="#fff">${b.md.toFixed(1)} MD</text>`;
    });

    svg += '</svg>';
    wrap.innerHTML = svg;
  }

  function exportGanttPng(){
    const svgEl = q('#ganttSvg');
    if(!svgEl){
      alert('Render the Gantt first.');
      return;
    }

    const xml = new XMLSerializer().serializeToString(svgEl);
    const svgBlob = new Blob([xml], { type: 'image/svg+xml;charset=utf-8' });
    const url = URL.createObjectURL(svgBlob);
    const img = new Image();

    img.onload = function(){
      const canvas = document.createElement('canvas');
      canvas.width = svgEl.viewBox.baseVal.width || svgEl.clientWidth;
      canvas.height = svgEl.viewBox.baseVal.height || svgEl.clientHeight;
      const ctx = canvas.getContext('2d');
      ctx.fillStyle = '#ffffff';
      ctx.fillRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(img, 0, 0);
      URL.revokeObjectURL(url);

      const a = document.createElement('a');
      a.download = 'gantt.png';
      a.href = canvas.toDataURL('image/png');
      a.click();
    };

    img.onerror = function(){ URL.revokeObjectURL(url); };
    img.src = url;
  }

  function wireGantt(){
    const genBtn = q('#generateGanttBtn');
    const renderBtn = q('#renderGanttBtn');
    const exportBtn = q('#exportGanttPngBtn');
    const card = q('#ganttCard');

    if(genBtn && card){
genBtn.addEventListener('click', async function(){
        card.style.display = '';
        const start = q('#ganttStartDate');
        if(start && !start.value) start.value = new Date().toISOString().slice(0,10);
        await renderGantt();
      });
    }

    if(renderBtn) renderBtn.addEventListener('click', renderGantt);
    if(exportBtn) exportBtn.addEventListener('click', exportGanttPng);
  }

  document.addEventListener('DOMContentLoaded', wireGantt);
})();



  document.addEventListener('DOMContentLoaded', () => {
    try { updateCsvButtonEnabled(); } catch(e) {}
  });

</script>
         </div>
      </div>
      </div>


      <div id="jiraParentModal" class="modal hidden" aria-hidden="true">
         <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="jiraParentTitle">
            <div class="modal-header">
               <h2 id="jiraParentTitle">Create the parent task in Jira</h2>
               <button class="modal-close" id="closeJiraParent" type="button" aria-label="Close">&times;</button>
            </div>
            <div class="modal-body">
               <p style="margin-top:0;">
                  Before downloading the CSV, create the parent task in Jira. Copy the task key and paste it here.
               </p>

               <label for="jiraParentKey" style="display:block;font-weight:600;margin:12px 0 6px 0;">
                  Parent Task Key
               </label>
               <input id="jiraParentKey" type="text" inputmode="text" placeholder="e.g. HGS-36981" style="width:100%;padding:10px 12px;border:1px solid var(--border);border-radius:6px;" />

               <div id="jiraParentError" style="display:none;color:#B42318;margin-top:8px;font-size:13px;">
                  Please enter a valid Jira key format (e.g. HGS-36981).
               </div>

               <div style="display:flex;gap:10px;justify-content:flex-end;margin-top:16px;">
                  <button id="jiraParentCancel" type="button" class="calculate-btn" style="background:#ffffff;color:var(--brand-navy);border:1px solid var(--border);">
                     Cancel
                  </button>
                  <button id="jiraParentDownload" type="button" class="calculate-btn" disabled>
                     Download CSV
                  </button>
               </div>

               <hr style="margin:18px 0;border:none;border-top:1px solid #e0e0e0;" />

               <div style="font-size:13px;color:var(--muted);line-height:1.4;">
                  Tip: Use the same parent key for all sub-tasks generated from this estimation.
               </div>
            </div>
         </div>
      </div>


      <div id="jiraHelpModal" class="modal hidden" aria-hidden="true">
         <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="jiraHelpTitle">
            <div class="modal-header">
               <h2 id="jiraHelpTitle">How to import the CSV into Jira</h2>
               <button class="modal-close" id="closeJiraHelp" type="button" aria-label="Close">&times;</button>
            </div>
            <div class="modal-body">
               <!-- WRITE YOUR INSTRUCTIONS HERE -->
               <ol>
                  <li>Open https://sapiens-digital.atlassian.net/issues/</li>
                  <li>In the top right corner, click the three dots (...) next to Share and Export.</li>
                  <li>Select Import work items from CSV.</li>
                  <li>The Bulk create: Setup screen opens. Click Choose File and select the CSV file.</li>
                  <li>Click Next.</li>
				  <li>Select the target project in Import to Project.</li>
<li>Leave all other settings as they are and click Next.</li>
<li>In Map fields, match each CSV field to the same Jira field.</li>
<li>For example: CSV field Affects versions  Jira field Affects versions.</li>
<li>Click Next.</li>
<li>In Map values, no changes are required.</li>
<li>Click Next to complete the import.</li>
               </ol>

  <div style="display:flex;justify-content:flex-end;margin-top:14px;">
                  <button id="downloadJiraInstructionsTxt" type="button" class="calculate-btn csv-btn">Download instructions (.txt)</button>
               </div>

            </div>
         </div>
      </div>

   
<!-- Parent Task Modal -->
<div id="parentTaskModal" class="modal hidden">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Create Parent Task in Jira</h2>
      <button class="modal-close" id="closeParentModal">&times;</button>
    </div>
    <div class="modal-body">
      <p>
        Before downloading the CSV, you must create a parent Task in Jira.
        This Task will be used as the parent for all generated sub-tasks.
      </p>

      <label for="parentTaskKey"><strong>Parent Task Key</strong> (e.g. HGS-36981)</label>
      <input
        type="text"
        id="parentTaskKey"
        placeholder="HGS-36981"
        style="width:100%; margin-top:8px; padding:8px;"
      />

      <p id="parentKeyError" style="color:#c62828; display:none; margin-top:8px;">
        Please enter a valid Jira issue key (e.g. HGS-36981).
      </p>

      <div style="margin-top:20px; text-align:right;">
        <button id="confirmParentKeyBtn" class="next-button" disabled>
          Continue to CSV Download
        </button>
      </div>
    </div>
  </div>
</div>


<script>

(function () {
  const STORAGE_KEY = "jiraParentTaskKey";

  const downloadBtn = document.getElementById("downloadJiraCsvBtn");
  const modal = document.getElementById("parentTaskModal");
  const closeBtn = document.getElementById("closeParentModal");
  const confirmBtn = document.getElementById("confirmParentKeyBtn");
  const input = document.getElementById("parentTaskKey");
  const error = document.getElementById("parentKeyError");

 // Newer modal flow (jiraParentModal + wireJiraParentModal) already exists above.
  // If that flow is present, skip this legacy wiring to avoid duplicate click handlers.
  if (document.getElementById("jiraParentModal")) return;

  if (!downloadBtn || !modal || !closeBtn || !confirmBtn || !input || !error) return;
  function isValidKey(value) {
    return /^[A-Z]+-\d+$/.test(String(value || "").trim());
  }

  function getStoredKey() {
    const v = localStorage.getItem(STORAGE_KEY);
    return isValidKey(v) ? v.trim() : "";
  }

  function setStoredKey(v) {
    localStorage.setItem(STORAGE_KEY, v.trim());
  }

  function clearStoredKey() {
    localStorage.removeItem(STORAGE_KEY);
  }

  function openModal() {
    modal.classList.remove("hidden");
    input.focus();
  }

  function closeModal() {
    modal.classList.add("hidden");
  }

  function downloadCsv(parentKey) {
    window.__JIRA_PARENT_TASK_KEY__ = parentKey;

    if (typeof generateCSV === "function") {
      generateCSV(parentKey);
      return;
    }

    alert("CSV generator function is missing: generateCSV(parentKey).");
  }

  // Prefill from storage
  const stored = getStoredKey();
  if (stored) {
    input.value = stored;
    confirmBtn.disabled = false;
    error.style.display = "none";
    window.__JIRA_PARENT_TASK_KEY__ = stored;
  }

  downloadBtn.addEventListener("click", function (e) {
    e.preventDefault();
    const key = getStoredKey();
    if (key) {
      downloadCsv(key);
      return;
    }
    openModal();
  });

   closeBtn.addEventListener("click", function () {
    closeModal();
  });

  // Close on backdrop click
  modal.addEventListener("click", function (e) {
    if (e.target === modal) closeModal();
  });

  // Close on ESC
  document.addEventListener("keydown", function (e) {
    if (e.key === "Escape" && !modal.classList.contains("hidden")) {
      closeModal();
    }
  });

  input.addEventListener("input", function () {
    const value = input.value.trim();
    const ok = isValidKey(value);
    confirmBtn.disabled = !ok;
    error.style.display = ok || value === "" ? "none" : "block";
  });

  confirmBtn.addEventListener("click", function () {
    const key = input.value.trim();
    if (!isValidKey(key)) return;

    setStoredKey(key);
    closeModal();
    downloadCsv(key);
  });
})();


               const EXPORT_SCHEMA_VERSION = 1;

               function isResultsVisible(){
                 return document.getElementById("resultsSection") && document.getElementById("resultsSection").style.display !== "none";
               }

               function getCurrentView(){
                 const step1Visible = document.getElementById("step1") && document.getElementById("step1").style.display !== "none";
                 const step2Visible = document.getElementById("step2") && document.getElementById("step2").style.display !== "none";
                 const resultsVisible = isResultsVisible();
                 if(resultsVisible) return "results";
                 if(step2Visible) return "step2";
                 if(step1Visible) return "step1";
                 return "step1";
               }

               function collectInterfacesState(){
                 const rows = document.querySelectorAll("#interfacesTable tr.interface-row");
                 return Array.from(rows).map(row => {
                   const typeEl = row.querySelector(".interface-type");
                   const qtyEl = row.querySelector(".interface-qty");
                   return { type: typeEl ? typeEl.value : "simple", qty: qtyEl ? (parseInt(qtyEl.value, 10) || 0) : 0 };
                 });
               }
			   function applyInterfacesState(rows){
                 const table = document.getElementById("interfacesTable");
                 if(!table) return;

                 const normalizedRows = Array.isArray(rows) ? rows : [];
                 table.querySelectorAll("tr.interface-row").forEach((r) => r.remove());

                 if(!normalizedRows.length) return;
                 normalizedRows.forEach((entry) => {
                   if(typeof addInterfaceRow === "function") addInterfaceRow();
                   const row = table.querySelector("tr.interface-row:last-of-type");
                   if(!row) return;

                   const typeEl = row.querySelector(".interface-type");
                   const qtyEl = row.querySelector(".interface-qty");
                   if(typeEl) typeEl.value = String(entry && entry.type ? entry.type : "simple");
                   if(qtyEl) qtyEl.value = Number.isFinite(Number(entry && entry.qty)) ? String(Number(entry.qty)) : "0";
                 });
               }

               function collectTechImpactState(){
                 const rows = document.querySelectorAll("#techStackFullTbody tr");
                 return Array.from(rows).map((row) => {
                   const cells = row.querySelectorAll("td");
                   const area = String(cells[0]?.textContent || "").trim();
                   const dev = !!row.querySelector('input[data-tech-impact="dev"]')?.checked;
                   const devops = !!row.querySelector('input[data-tech-impact="devops"]')?.checked;
                   if(!area) return null;
                   return { area, dev, devops };
                 }).filter(Boolean);
               }

               function applyTechImpactState(rows){
                 const lookup = new Map();
                 if(Array.isArray(rows)){
                   rows.forEach((entry) => {
                     const key = String(entry && entry.area ? entry.area : "").trim();
                     if(!key) return;
                     lookup.set(key, { dev: !!entry.dev, devops: !!entry.devops });
                   });
                 }

                 document.querySelectorAll("#techStackFullTbody tr").forEach((row) => {
                   const area = String(row.querySelector("td")?.textContent || "").trim();
                   if(!area || !lookup.has(area)) return;
                   const saved = lookup.get(area);

                   const devEl = row.querySelector('input[data-tech-impact="dev"]');
                   const devopsEl = row.querySelector('input[data-tech-impact="devops"]');
                   if(devEl) devEl.checked = !!saved.dev;
                   if(devopsEl) devopsEl.checked = !!saved.devops;
                 });
               }

               function collectManualTasksState(){
                 const rows = document.querySelectorAll("#manualTasksBody tr");
                 return Array.from(rows).map(tr => {
                   const get = (sel) => tr.querySelector(sel);
                   return {
                     taskName: get("input[data-mt='taskName']")?.value ?? "",
                     phase: get("select[data-mt='phase']")?.value ?? "Build & System test",
                     subPhase: get("input[data-mt='subPhase']")?.value ?? "",
                     effort: parseFloat(get("input[data-mt='effort']")?.value) || 0,
                     notes: get("input[data-mt='notes']")?.value ?? ""
                   };
                 });
               }

               
               function collectDetailedBreakdownUserRowsState(){
  const tbody = document.querySelector("#detailedTable tbody");
  if(!tbody) return [];
  const rows = Array.from(tbody.querySelectorAll('tr[data-user-added="1"]'));
  return rows.map((tr, idx) => {
    const getVal = (sel) => (tr.querySelector(sel)?.value ?? "").trim();
    const getNum = (sel, fallback=0) => {
      const v = parseFloat(tr.querySelector(sel)?.value);
      return Number.isFinite(v) ? v : fallback;
    };
    const getInt = (sel, fallback=0) => {
      const v = parseInt(tr.querySelector(sel)?.value, 10);
      return Number.isFinite(v) ? v : fallback;
    };

    const override = !!tr.querySelector('[data-user-override="1"]')?.checked;
    const baseMd = getNum('[data-user-base-md="1"]', 0);
    const overrideMdRaw = parseFloat(tr.querySelector('[data-user-override-md="1"]')?.value);
    const overrideMd = Number.isFinite(overrideMdRaw) ? overrideMdRaw : null;
    const total = override && overrideMd !== null ? overrideMd : baseMd;

    const payload = {
      origin: "breakdown",
      id: tr.getAttribute("data-row-id") || "",
      uiIndex: idx,
      phase: getVal('[data-user-phase="1"]'),
      subPhase: getVal('[data-user-sub="1"]'),
      workItem: getVal('[data-user-work="1"]'),
      qty: getInt('[data-user-qty="1"]', 1),
      rate: getVal('[data-user-rate="1"]'),
      baseMd,
      override,
      overrideMd,
      notes: getVal('[data-user-notes="1"]'),
      totalMd: total
    };
                 });
               }

               
               function collectDetailedBreakdownUserRowsState(){
  const tbody = document.querySelector("#detailedTable tbody");
  if(!tbody) return [];
  const rows = Array.from(tbody.querySelectorAll('tr[data-user-added="1"]'));
  return rows.map((tr, idx) => {
    const getVal = (sel) => (tr.querySelector(sel)?.value ?? "").trim();
    const getNum = (sel, fallback=0) => {
      const v = parseFloat(tr.querySelector(sel)?.value);
      return Number.isFinite(v) ? v : fallback;
    };
    const getInt = (sel, fallback=0) => {
      const v = parseInt(tr.querySelector(sel)?.value, 10);
      return Number.isFinite(v) ? v : fallback;
    };

    const override = !!tr.querySelector('[data-user-override="1"]')?.checked;
    const baseMd = getNum('[data-user-base-md="1"]', 0);
    const overrideMdRaw = parseFloat(tr.querySelector('[data-user-override-md="1"]')?.value);
    const overrideMd = Number.isFinite(overrideMdRaw) ? overrideMdRaw : null;
    const total = override && overrideMd !== null ? overrideMd : baseMd;

    const payload = {
      origin: "breakdown",
      id: tr.getAttribute("data-row-id") || "",
      uiIndex: idx,
      phase: getVal('[data-user-phase="1"]'),
      subPhase: getVal('[data-user-sub="1"]'),
      workItem: getVal('[data-user-work="1"]'),
      qty: getInt('[data-user-qty="1"]', 1),
      rate: getVal('[data-user-rate="1"]'),
      baseMd,
      override,
      overrideMd,
      notes: getVal('[data-user-notes="1"]'),
      totalMd: total
    };
    const isEffectivelyEmpty =
      !payload.phase &&
      !payload.subPhase &&
      !payload.workItem &&
      !payload.rate &&
      !payload.notes &&
      payload.baseMd === 0 &&
      payload.override !== true &&
      (payload.overrideMd === null || payload.overrideMd === 0);
    return isEffectivelyEmpty ? null : payload;
  }).filter(Boolean);
}

function applyDetailedBreakdownUserRowsState(savedRows){
  const tbody = document.querySelector("#detailedTable tbody");
  if(!tbody || !Array.isArray(savedRows) || !savedRows.length) return;
  if(typeof window.__makeUserDetailedRow !== "function") return;

  const userRowsSorted = savedRows
    .filter(Boolean)
    .slice()
    .sort((a, b) => (Number(a.uiIndex) || 0) - (Number(b.uiIndex) || 0));

  userRowsSorted.forEach((state) => {
    const row = window.__makeUserDetailedRow();
    if(!row) return;

    if(state.id) row.setAttribute("data-row-id", state.id);

    const setVal = (sel, val) => {
      const el = row.querySelector(sel);
      if(el) el.value = val == null ? "" : String(val);
    };

    setVal('[data-user-phase="1"]', state.phase || "");
    setVal('[data-user-sub="1"]', state.subPhase || "");
    setVal('[data-user-work="1"]', state.workItem || "");
    setVal('[data-user-qty="1"]', Number.isFinite(Number(state.qty)) ? Number(state.qty) : 1);
    setVal('[data-user-rate="1"]', state.rate || "");
    setVal('[data-user-base-md="1"]', Number.isFinite(Number(state.baseMd)) ? Number(state.baseMd) : 0);
    setVal('[data-user-notes="1"]', state.notes || "");

    const cb = row.querySelector('[data-user-override="1"]');
    const ov = row.querySelector('[data-user-override-md="1"]');
    if(cb) cb.checked = !!state.override;
    if(ov){
      ov.disabled = !cb || !cb.checked;
      if(state.overrideMd !== null && state.overrideMd !== undefined && Number.isFinite(Number(state.overrideMd))){
        ov.value = String(Number(state.overrideMd));
      }else{
        ov.value = "";
      }
    }

    tbody.appendChild(row);
  });
}

// --- Restored wiring: Manual tasks ---
// --- Manual Tasks wiring (UI-compatible) ---
function wireManualTasks(){
  const addBtn = document.getElementById("addManualTaskBtn");
  const tbody = document.getElementById("manualTasksBody");
  const empty = document.getElementById("manualTasksEmpty");
  if(!addBtn || !tbody) return;

  const getAllItems = () => {
    if(window.lastBreakdownItems && Array.isArray(window.lastBreakdownItems)) return window.lastBreakdownItems;
    if(window.calculationData && Array.isArray(window.calculationData.items)) return window.calculationData.items;
    return [];
  };

  const listItemsForPhase = (phase) => {
    const p = String(phase || "").trim();
    if(!p) return [];
    return getAllItems()
      .filter(x => String(x.phase || "").trim() === p)
      .map(x => {
        const sub = String(x.subPhase || "").trim();
        const wi = String(x.workItem || x.name || "").trim();
        return (sub ? (sub + " - ") : "") + (wi || "");
      })
      .filter(Boolean);
  };

  const rebuildEmpty = () => {
    if(!empty) return;
    const hasRows = tbody.querySelectorAll("tr").length > 0;
    empty.style.display = hasRows ? "none" : "block";
  };

  const readStateFromDom = () => {
    state.manualTasks = Array.from(tbody.querySelectorAll("tr")).map(tr => {
      const phase = tr.querySelector('input[data-field="phase"]')?.value || "";
      const subPhase = tr.querySelector('input[data-field="subPhase"]')?.value || "";
      const workItem = tr.querySelector('input[data-field="workItem"]')?.value || "";
      const mdRaw = tr.querySelector('input[data-field="md"]')?.value;
      const md = parseFloat(mdRaw);
      const when = tr.querySelector('select[data-field="when"]')?.value || "After";
      const anchor = tr.querySelector('input[data-field="anchor"]')?.value || "";
      return {
        id: tr.getAttribute("data-id") || "",
        phase: String(phase).trim(),
        subPhase: String(subPhase).trim(),
        workItem: String(workItem).trim(),
        md: Number.isFinite(md) ? md : 0,
        when: String(when).trim(),
        anchor: String(anchor).trim()
      };
    }).filter(t => t.phase || t.workItem || t.md > 0);

    rebuildEmpty();
    // No auto-calculate here - user runs Calculate explicitly.
  };

  const buildTextInput = (placeholder, value, field) => {
    const inp = document.createElement("input");
    inp.className = "input-sm";
    inp.type = "text";
    inp.placeholder = placeholder;
    inp.value = value || "";
    inp.setAttribute("data-field", field);
    return inp;
  };

  const buildMdInput = (value) => {
    const inp = document.createElement("input");
    inp.className = "input-sm";
    inp.type = "number";
    inp.min = "0";
    inp.step = "0.5";
    inp.value = (value != null) ? String(value) : "0";
    inp.setAttribute("data-field", "md");
    return inp;
  };

  const buildOrderCell = (whenValue, anchorValue) => {
    const wrap = document.createElement("div");
    wrap.style.display = "flex";
    wrap.style.gap = "8px";
    wrap.style.alignItems = "center";

    const sel = document.createElement("select");
    sel.className = "input-sm";
    sel.style.width = "120px";
    sel.setAttribute("data-field", "when");
    ["Before","After"].forEach(v => {
      const o = document.createElement("option");
      o.value = v;
      o.textContent = v;
      sel.appendChild(o);
    });
    sel.value = whenValue || "After";

    const anchor = document.createElement("input");
    anchor.className = "input-sm";
    anchor.type = "text";
    anchor.placeholder = "Relative to (optional)";
    anchor.value = anchorValue || "";
    anchor.setAttribute("data-field", "anchor");

    wrap.appendChild(sel);
    wrap.appendChild(anchor);
    return wrap;
  };

  const renderExistingList = (phase, hostDiv) => {
    const items = listItemsForPhase(phase);
    if(!items.length){
      hostDiv.innerHTML = "<span class='small'>No calculated items for this phase yet. Run Calculate to populate.</span>";
      return;
    }
    const max = 8;
    const shown = items.slice(0, max);
    hostDiv.innerHTML = "<div class='small' style='margin-bottom:6px;'>Items in this phase:</div>"
      + "<div style='display:flex;flex-direction:column;gap:4px;'>"
      + shown.map(s => "<div class='details-item' style='margin:0;'>" + escapeHtml(s) + "</div>").join("")
      + (items.length > max ? ("<div class='small'>+" + (items.length - max) + " more</div>") : "")
      + "</div>";
  };

  const addRow = (task = {}) => {
    const id = task.id || ("mt_" + Date.now() + "_" + Math.floor(Math.random()*10000));
    const tr = document.createElement("tr");
    tr.setAttribute("data-id", id);

    const phaseTd = document.createElement("td");
    const phaseInp = buildTextInput("Phase", task.phase, "phase");
    phaseTd.appendChild(phaseInp);

    const subTd = document.createElement("td");
    const subInp = buildTextInput("Sub phase", task.subPhase, "subPhase");
    subTd.appendChild(subInp);

    const wiTd = document.createElement("td");
    const wiInp = buildTextInput("Work item", task.workItem, "workItem");
    wiTd.appendChild(wiInp);

    const mdTd = document.createElement("td");
    const mdInp = buildMdInput(task.md);
    mdTd.appendChild(mdInp);

    const orderTd = document.createElement("td");
    const orderWrap = buildOrderCell(task.when, task.anchor);
    orderTd.appendChild(orderWrap);

    const existingTd = document.createElement("td");
    const existingDiv = document.createElement("div");
    existingDiv.className = "details-panel";
    existingDiv.style.maxHeight = "220px";
    existingDiv.style.overflow = "auto";
    existingTd.appendChild(existingDiv);

    const delTd = document.createElement("td");
    const delBtn = document.createElement("button");
    delBtn.type = "button";
    delBtn.className = "link-button";
    delBtn.textContent = "";
    delTd.appendChild(delBtn);

    tr.appendChild(phaseTd);
    tr.appendChild(subTd);
    tr.appendChild(wiTd);
    tr.appendChild(mdTd);
    tr.appendChild(orderTd);
    tr.appendChild(existingTd);
    tr.appendChild(delTd);

    const onAnyChange = () => {
      renderExistingList(phaseInp.value, existingDiv);
      readStateFromDom();
    };

    phaseInp.addEventListener("input", onAnyChange);
    subInp.addEventListener("input", onAnyChange);
    wiInp.addEventListener("input", onAnyChange);
    mdInp.addEventListener("input", onAnyChange);
    orderWrap.querySelector('select[data-field="when"]').addEventListener("change", onAnyChange);
    orderWrap.querySelector('input[data-field="anchor"]').addEventListener("input", onAnyChange);

    delBtn.addEventListener("click", () => {
      tr.remove();
      readStateFromDom();
    });

    tbody.appendChild(tr);
    renderExistingList(phaseInp.value, existingDiv);
    rebuildEmpty();
    readStateFromDom();
  };

  if(!addBtn.__wired){
    addBtn.__wired = true;
    addBtn.addEventListener("click", () => addRow({}));
  }

  // initial load
  if(Array.isArray(state.manualTasks) && state.manualTasks.length){
    tbody.innerHTML = "";
    state.manualTasks.forEach(addRow);
  } else {
    rebuildEmpty();
  }
}
// --- End Manual Tasks wiring ---

// --- Restored: Upgrade Scope Summary + Technology Stack Delta (full) ---
function updateTechDashboard(){
  const fromKey = document.getElementById("coreFrom") ? document.getElementById("coreFrom").value : "";
  const toKey = document.getElementById("coreTo") ? document.getElementById("coreTo").value : "";

  const scopeBody = document.getElementById("upgradeScopeTbody");
  const fullBody = document.getElementById("techStackFullTbody");

  if(scopeBody) scopeBody.innerHTML = "";
  if(fullBody) fullBody.innerHTML = "";

  if(!fromKey || !toKey || !CORE_TECH_STACK || !CORE_TECH_STACK[fromKey] || !CORE_TECH_STACK[toKey]){
    return;
  }

  const from = CORE_TECH_STACK[fromKey];
  const to = CORE_TECH_STACK[toKey];

  // Scope summary
  if(scopeBody){
    const majorFrom = parseInt(String(fromKey).split("_")[0].replace(/[^\d]/g,""), 10);
    const majorTo = parseInt(String(toKey).split("_")[0].replace(/[^\d]/g,""), 10);
    const majorDelta = (Number.isFinite(majorTo) && Number.isFinite(majorFrom)) ? Math.max(0, (majorTo - majorFrom)) : 0;

    const rows = [
      ["From", escapeHtml(getSelectedOptionText("coreFrom"))],
      ["To", escapeHtml(getSelectedOptionText("coreTo"))],
      ["Major version delta", String(majorDelta)]
    ];

    rows.forEach(([k,v]) => {
      const tr = document.createElement("tr");
      tr.innerHTML = "<td>" + escapeHtml(k) + "</td><td><strong>" + v + "</strong></td>";
      scopeBody.appendChild(tr);
    });
  }

  // Full delta table - compare keys present in either
  if(fullBody){
    const keys = new Set(Object.keys(from || {}).concat(Object.keys(to || {})));
    Array.from(keys).forEach(k => {
      const a = (from && from[k] != null) ? String(from[k]) : "";
      const b = (to && to[k] != null) ? String(to[k]) : "";
      if(!a && !b) return;

      const tr = document.createElement("tr");
      tr.innerHTML =
        "<td>" + escapeHtml(k) + "</td>" +
        "<td>" + escapeHtml(a) + "</td>" +
        "<td>" + escapeHtml(b) + "</td>" +
        "<td><input type=\"checkbox\" class=\"checkbox-sm\" data-tech-impact=\"dev\" /></td>" +
        "<td><input type=\"checkbox\" class=\"checkbox-sm\" data-tech-impact=\"devops\" /></td>";
      fullBody.appendChild(tr);
    });

    // If the table expects 3 columns but CSS assumes 2, it's still OK visually because it's a form-table.
  }
}


function filterCoreFromOptions(){
  const fromSel = document.getElementById("coreFrom");
  if(!fromSel) return;

  const fromKey = String(fromSel.value || "");
  const major = parseInt(fromKey.split("_")[0].replace(/[^\d]/g,""), 10);

  // Requirement: when starting from 18+, hide versions before 18 in the "From" dropdown
  const hideBefore18 = Number.isFinite(major) && major >= 18;

  Array.from(fromSel.options).forEach(opt => {
    const k = String(opt.value || "");
    const m = parseInt(k.split("_")[0].replace(/[^\d]/g,""), 10);
    if(!k){ opt.hidden = false; return; } // keep "Select..."
    if(!Number.isFinite(m)){ opt.hidden = false; return; }
    opt.hidden = hideBefore18 && m < 18;
  });
}

function wireTechDashboard(){
  const fromSel = document.getElementById("coreFrom");
  const toSel = document.getElementById("coreTo");
  if(fromSel){
    fromSel.addEventListener("change", updateTechDashboard);
        fromSel.addEventListener("change", filterCoreFromOptions);
fromSel.addEventListener("input", updateTechDashboard);
  }
  if(toSel){
    toSel.addEventListener("change", updateTechDashboard);
    toSel.addEventListener("input", updateTechDashboard);
  }
  filterCoreFromOptions();

  updateTechDashboard();
}
// --- End restored wiring ---

function setStepIndicator(step){
  const normalizedStep = Number(step) >= 2 ? 2 : 1;
  document.querySelectorAll("[data-step-indicator]").forEach((indicator) => {
    indicator.textContent = `Page ${normalizedStep} of 2`;
  });
}

function showStep(step){
  const s1 = document.getElementById("step1");
  const s2 = document.getElementById("step2");
  const rs = document.getElementById("resultsSection");
  if(s1) s1.style.display = (step === 1) ? "block" : "none";
  if(s2) s2.style.display = (step === 2) ? "block" : "none";
  if(step === 2 && typeof applyAutoCountsToInputs==="function"){ applyAutoCountsToInputs(); }
  if(step === 2){ applyAutoCountsToInputs(); }
  if(rs) rs.style.display = (step === 3) ? "block" : "none";
  if(typeof setStepIndicator === "function"){
    setStepIndicator(step === 3 ? 3 : step);
  }

// --- Patch: apply autoCounts into Step 2 inputs ---
function applyAutoCountsToInputs(){
  if(!window.autoCounts) return;

  const setNum = (id, v) => {
    const elx = document.getElementById(id);
    if(!elx) return;
    const n = parseInt(v, 10);
    elx.value = Number.isFinite(n) ? String(n) : String(parseInt(elx.value, 10) || 0);
  };

  setNum("xmlFiles", window.autoCounts.xmlFiles);
  setNum("jspFiles", window.autoCounts.jspFiles);
  setNum("changedMethods", window.autoCounts.changedMethods);
  setNum("changedQueries", window.autoCounts.changedQueries);
  setNum("sessionBeans", window.autoCounts.sessionBeans);

  // If you have merges in autoCounts (optional)
  if(typeof window.autoCounts.merges !== "undefined"){
    setNum("merges", window.autoCounts.merges);
  }
}


}

function goBack(){
  showStep(1);
}

function wireStep1Navigation(){
  const nextBtn = document.getElementById("nextBtn");
const fromSel = document.getElementById("coreFrom");
  const toSel = document.getElementById("coreTo");
  if(fromSel) fromSel.required = true;
  if(toSel) toSel.required = true;

  const refresh = () => {
    if(!nextBtn) return;
    const fromVal = fromSel ? String(fromSel.value || "").trim() : "";
    const toVal = toSel ? String(toSel.value || "").trim() : "";
    nextBtn.disabled = !(fromVal && toVal);
  };

  if(fromSel){
    fromSel.addEventListener("change", refresh);
    fromSel.addEventListener("input", refresh);
  }
  if(toSel){
    toSel.addEventListener("change", refresh);
    toSel.addEventListener("input", refresh);
  }

  if(nextBtn){
    nextBtn.addEventListener("click", function(){
      refresh();
      if(nextBtn.disabled) return;
      showStep(2);
    
      
      if(typeof applyAutoCountsToInputs === "function") applyAutoCountsToInputs();
	  });
}
  refresh();
}



/* --- Editable task breakdown: add row below (user tasks inside table) --- */
(function(){
  function qs(sel, root){ return (root || document).querySelector(sel); }
  function qsa(sel, root){ return Array.from((root || document).querySelectorAll(sel)); }

  function isSpecialRow(tr){
    const tds = Array.from(tr.querySelectorAll("td"));
    if(!tds.length) return true;
    const txt = (tr.textContent || "").toUpperCase();
    return txt.includes("TOTAL DEV EFFORT") || txt.includes("GLOBAL BUFFER") || txt.includes("NOTES / ASSUMPTIONS") || txt.includes("TOTAL (INCL. BUFFER)");
	}

  function ensureAddButtons(){
    const tbody = qs("#detailedTable tbody");
    if(!tbody) return;
    qsa("tr", tbody).forEach((tr) => {
      if(isSpecialRow(tr)) return;
	  
      const firstTd = tr.querySelector("td");
      if(!firstTd) return;
      if(firstTd.querySelector(".row-add-btn")) return;

      const btn = document.createElement("button");
      btn.type = "button";
      btn.className = "row-add-btn";
      btn.title = "Add row below";
      btn.textContent = "";
      btn.setAttribute("data-add-row", "1");
      firstTd.prepend(btn);
    });
  }

  function nextUserRowId(){
    window.__userRowSeq = (window.__userRowSeq || 0) + 1;
    return "user_row_" + window.__userRowSeq;
  }

  function setRowTotal(tr){
    const baseInp = tr.querySelector('[data-user-base-md="1"]');
    const cb = tr.querySelector('[data-user-override="1"]');
    const overrideInp = tr.querySelector('[data-user-override-md="1"]');
    const totalTd = tr.querySelector('[data-user-total="1"]');

    const base = parseFloat(baseInp ? baseInp.value : "") || 0;
    const ovEnabled = !!(cb && cb.checked);
    const ov = parseFloat(overrideInp ? overrideInp.value : "");
    const total = (ovEnabled && Number.isFinite(ov)) ? ov : base;

    if(totalTd) totalTd.textContent = total.toFixed(1);
  }

  function recomputeGrandTotal(){
   if(typeof applyOverridesAndRefresh === "function" && window.state?.lastCalc){
      applyOverridesAndRefresh();
      return;
    }
    const tbody = qs("#detailedTable tbody");
    if(!tbody) return;

    let sum = 0;
    qsa("tr", tbody).forEach((tr) => {
      if(isSpecialRow(tr)) return;
      const totalTd = tr.querySelector('[data-user-total="1"]');
      if(totalTd){
        sum += (parseFloat(totalTd.textContent) || 0);
        return;
      }
      // fallback for generated rows: last td is total md
      const tds = Array.from(tr.querySelectorAll("td"));
      if(tds.length){
        const lastText = (tds[tds.length - 1].textContent || "").trim();
        const v = parseFloat(lastText);
        if(Number.isFinite(v)) sum += v;
      }
    });

    // Update TOTAL DEV EFFORT last cell if present
    const totalRow = qsa("tr", tbody).find(tr => (tr.textContent || "").includes("TOTAL DEV EFFORT"));
    if(totalRow){
      const tds = Array.from(totalRow.querySelectorAll("td"));
      const last = tds[tds.length - 1];
      if(last) last.innerHTML = "<strong>" + sum.toFixed(1) + "</strong>";
    }

    // Update big total header if exists
    const totalEffort = qs("#totalEffort");
    if(totalEffort && totalEffort.textContent){
      // Keep original label style (it usually includes "Total XXX MD")
      totalEffort.textContent = "Total " + sum.toFixed(0) + " MD";
    }
  }

  function makeUserRow(){
  const tr = document.createElement("tr");
  tr.setAttribute("data-row-id", nextUserRowId());
  tr.setAttribute("data-manual", "1");
  tr.setAttribute("data-user-added", "1");

  tr.innerHTML =
    "<td>" +
            "<button type='button' class='row-add-btn' title='Add row below' data-add-row='1'></button>" +
      "<button type='button' class='row-del-btn' title='Delete row' data-del-row='1'>x</button>" +
      "<input class='detailed-input' placeholder='Phase' data-user-phase='1' />" +
    "</td>" +
    "<td><input class='detailed-input' placeholder='Sub phase' data-user-sub='1' /></td>" +
    "<td><input class='detailed-input' placeholder='Work item' data-user-work='1' /></td>" +
    "<td><input class='detailed-input detailed-input-sm' type='number' min='0' step='1' value='1' data-user-qty='1' /></td>" +
    "<td><input class='detailed-input detailed-input-sm' placeholder='Rate' data-user-rate='1' /></td>" +
    "<td><input class='detailed-input detailed-input-md' type='number' min='0' step='0.5' value='0' data-user-base-md='1' /></td>" +
    "<td style='text-align:center;'><input type='checkbox' class='checkbox-sm' data-user-override='1' disabled /></td>" +
    "<td><input class='detailed-input detailed-input-md' type='number' min='0' step='0.5' value='' disabled data-user-override-md='1' /></td>" +
    "<td><input class='detailed-input' placeholder='Notes and assumptions' data-user-notes='1' /></td>" +
    "<td data-user-total='1'>0.0</td>";

  // Wire behavior
  const cb = tr.querySelector('[data-user-override="1"]');
  const ov = tr.querySelector('[data-user-override-md="1"]');
  const base = tr.querySelector('[data-user-base-md="1"]');

  function onChange(){
    
    setRowTotal(tr);
    recomputeGrandTotal();
  }
  if(cb) cb.checked = false;
  if(ov) ov.disabled = true;

  if(ov) ov.addEventListener("input", onChange);
  if(base) base.addEventListener("input", onChange);

  // Delete
  const delBtn = tr.querySelector('[data-del-row="1"]');
  if(delBtn){
    delBtn.addEventListener("click", function(){
      tr.remove();
      recomputeGrandTotal();
    });
  }

  return tr;
}

  function getRowPhaseValue(tr){
    if(!tr) return "";
    const inputPhase = tr.querySelector('[data-user-phase="1"]');
    if(inputPhase && String(inputPhase.value || "").trim()){
      return String(inputPhase.value || "").trim();
    }
    const firstTd = tr.querySelector("td");
    if(!firstTd) return "";
    const clone = firstTd.cloneNode(true);
    clone.querySelectorAll(".row-add-btn, .row-del-btn, input, button").forEach((n) => n.remove());
    return (clone.textContent || "").replace(/\s+/g, " ").trim();
  }

  // Expose for import/export persistence
  window.__makeUserDetailedRow = makeUserRow;

  function wireAddRowClicks(){
    const table = qs("#detailedTable");
    if(!table) return;

    table.addEventListener("click", (e) => {
      const btn = e.target && e.target.closest && e.target.closest('button[data-add-row="1"]');
      if(!btn) return;

      const tr = btn.closest("tr");
      const tbody = tr && tr.parentElement;
      if(!tr || !tbody) return;

      const newRow = makeUserRow();
      tr.insertAdjacentElement("afterend", newRow);

  const sourcePhase = getRowPhaseValue(tr);
      const phaseInp = newRow.querySelector('[data-user-phase="1"]');
      if(phaseInp){
        phaseInp.value = sourcePhase;
      }
	  
            // keep add buttons on editable rows
      ensureAddButtons();

      // focus first input
      if(phaseInp) phaseInp.focus();
    });
  }

  // Expose a hook so existing calculate flow can call it if needed
  window.__decorateDetailedBreakdown = function(){
    ensureAddButtons();
    recomputeGrandTotal();
  };

  
  function initAddButtonsObserver(){
    const tbody = qs("#detailedTable tbody");
    if(!tbody) return;
    try{
      const obs = new MutationObserver(() => {
        ensureAddButtons();
      });
      obs.observe(tbody, { childList: true, subtree: true });
      // keep reference to avoid GC
      window.__addButtonsObserver = obs;
    }catch(e){}
  }

document.addEventListener("DOMContentLoaded", function(){
    wireAddRowClicks();
    // In case results already visible on load (import json scenario)
    window.__decorateDetailedBreakdown();
    initAddButtonsObserver();
  });

  // Also decorate after calculation - we patch calculateAndScroll if it exists
  const __origCalc = window.calculateAndScroll;
  if(typeof __origCalc === "function"){
    window.calculateAndScroll = function(){
      const r = __origCalc.apply(this, arguments);
      try{ window.__decorateDetailedBreakdown(); }catch(_e){}
      return r;
    };
  }

  // Preserve user-added detailed rows across recalculation
  const __origCalcEffort = window.calculateEffort;
  if(typeof __origCalcEffort === "function"){
    window.calculateEffort = function(){
      let cached = [];
      try{ cached = collectDetailedBreakdownUserRowsState(); }catch(_e){ cached = []; }
      const r = __origCalcEffort.apply(this, arguments);
      try{
        // Re-apply rows after base table is rebuilt
        applyDetailedBreakdownUserRowsState(cached);
      
        try{ window.__decorateDetailedBreakdown(); }catch(_e){}
}catch(_e){}
      return r;
    };
  }

})();

</script>

</body>
</html>